> æ—¥åå·¥ä½œä¸­ä¸€ç›´è¦æ¥è§¦çš„å†…å®¹ å…¥è¡Œçš„æ ‡å‡†ğŸ§‘â€ğŸ’»
>
> - React
> - Vue

# Reactå…¥é—¨

å‚è€ƒå­¦ä¹ èµ„æº

- [é˜®å¤§çš„ Reactå…¥é—¨å®ä¾‹æ•™ç¨‹](https://www.ruanyifeng.com/blog/2015/03/react.html)
- [Reactå®˜ç½‘åŸºç¡€æ•™ç¨‹](https://react.docschina.org/docs/hello-world.html)
- Bç«™å°šç¡…è°·è¯¾ç¨‹

## ReactåŸºç¡€çŸ¥è¯†

#### HTMLæ¨¡æ¿

> ```jsx
> <!DOCTYPE html>
> <html>
>   <head>
>     <script src="../build/react.js"></script>
>     <script src="../build/react-dom.js"></script>
>     <script src="../build/browser.min.js"></script>
>   </head>
>   <body>
>     <div id="example"></div>
>     <script type="text/babel">
>       // ** Our code goes here! **
>     </script>
>   </body>
> </html>
> ```

 `<script>` æ ‡ç­¾çš„ `type` å±æ€§ä¸º `text/babel` ã€‚

è¿™æ˜¯å› ä¸º React ç‹¬æœ‰çš„ JSX è¯­æ³•ï¼Œè·Ÿ JavaScript ä¸å…¼å®¹ã€‚å‡¡æ˜¯ä½¿ç”¨ JSX çš„åœ°æ–¹ï¼Œéƒ½è¦åŠ ä¸Š `type="text/babel"` ã€‚

ä¸Šé¢ä»£ç ä¸€å…±ç”¨äº†ä¸‰ä¸ªåº“ï¼š `react.js` ã€`react-dom.js` å’Œ `Browser.js` ï¼Œå®ƒä»¬å¿…é¡»é¦–å…ˆåŠ è½½ã€‚å…¶ä¸­

- `react.js` æ˜¯ React çš„æ ¸å¿ƒåº“
- `react-dom.js` æ˜¯æä¾›ä¸ DOM ç›¸å…³çš„åŠŸèƒ½
- `Browser.js` çš„ä½œç”¨æ˜¯å°† JSX è¯­æ³•è½¬ä¸º JavaScript è¯­æ³•ï¼Œè¿™ä¸€æ­¥å¾ˆæ¶ˆè€—æ—¶é—´ï¼Œå®é™…ä¸Šçº¿çš„æ—¶å€™ï¼Œåº”è¯¥å°†å®ƒæ”¾åˆ°æœåŠ¡å™¨å®Œæˆã€‚

#### `ReactDOM.render()`

`ReactDOM.render` æ˜¯ React çš„æœ€åŸºæœ¬æ–¹æ³•ï¼Œç”¨äºå°†æ¨¡æ¿è½¬ä¸º HTML è¯­è¨€ï¼Œå¹¶æ’å…¥æŒ‡å®šçš„ DOM èŠ‚ç‚¹ã€‚

> ```jsx
> ReactDOM.render(
>   <h1>Hello, world!</h1>,
>   document.getElementById('example')
> );
> ```

ä¸Šé¢ä»£ç å°†ä¸€ä¸ª `h1` æ ‡é¢˜ï¼Œæ’å…¥ `example` èŠ‚ç‚¹ï¼ˆæŸ¥çœ‹ [`demo01`](https://github.com/ruanyf/react-demos/blob/master/demo01/index.html)ï¼‰ï¼Œè¿è¡Œç»“æœå¦‚ä¸‹ã€‚

![img](https://www.ruanyifeng.com/blogimg/asset/2015/bg2015033109.png)



## JSX

#### JSXè¯­æ³•

HTML è¯­è¨€ç›´æ¥å†™åœ¨ JavaScript è¯­è¨€ä¹‹ä¸­ï¼Œä¸åŠ ä»»ä½•å¼•å·ï¼Œè¿™å°±æ˜¯ [JSX çš„è¯­æ³•](https://facebook.github.io/react/docs/displaying-data.html#jsx-syntax)ï¼Œå®ƒå…è®¸ HTML ä¸ JavaScript çš„æ··å†™ï¼ˆæŸ¥çœ‹ [`Demo02`](https://github.com/ruanyf/react-demos/blob/master/demo02/index.html) ï¼‰ã€‚

> æ—§ç‰ˆæœ¬
>
> ```jsx
> var names = ['Alice', 'Emily', 'Kate'];
> 
> ReactDOM.render(
>   <div>
>   {
>     names.map(function (name) {
>       return <div>Hello, {name}!</div>
>     })
>   }
>   </div>,
>   document.getElementById('example')
> );
> ```

> æ–°ç‰ˆæœ¬
>
> æ¶‰åŠäº†keyçš„å†…å®¹
>
> > éœ€è¦æ³¨æ„ï¼å¦‚æœæ¶‰åŠåˆ°éå†åˆ—è¡¨çš„éœ€æ±‚ï¼Œkeyæœ€å¥½ä¸è¦ç”¨indexï¼
> >
> > ![image-20211026114735118](https://gitee.com/su-fangzhou/blog-image/raw/master/202110261147195.png)
> >
> > ![image-20211026114801860](https://gitee.com/su-fangzhou/blog-image/raw/master/202110261148929.png)
> >
> > å°ç»“ï¼šå¦‚æœä¸å­˜åœ¨å¯¹æ•°æ®çš„é€†åºæ·»åŠ ã€é€†åºåˆ é™¤ï¼Œä»…ä»…æ˜¯ä¸ºäº†æ¸²æŸ“åˆ—è¡¨ç”¨äºå±•ç¤ºï¼Œé‚£å°±å¯ä»¥ä½¿ç”¨indexä½œä¸ºkey
> >
> > ![image-20211026114904827](https://gitee.com/su-fangzhou/blog-image/raw/master/202110261149879.png)
>
> > å¼€å‘ä¸­å¦‚ä½•é€‰å–keyï¼Ÿ
> >
> > æœ‰å”¯ä¸€æ ‡è¯†å°½é‡è¿˜æ˜¯ç”¨å”¯ä¸€æ ‡è¯†ï¼
> >
> > ![image-20211026115023933](https://gitee.com/su-fangzhou/blog-image/raw/master/202110261150005.png)
>
> ```jsx
> ReactDOM.render(
>   <div>
>   {
>     names.map(function (name, index) {
>       return <div key={index}>Hello, {name}!</div>
>     })
>   }
>   </div>,
>   document.getElementById('example')
> );
> ```

ä¸Šé¢ä»£ç ä½“ç°äº† JSX çš„åŸºæœ¬è¯­æ³•è§„åˆ™ï¼šé‡åˆ° HTML æ ‡ç­¾ï¼ˆä»¥ `<` å¼€å¤´ï¼‰ï¼Œå°±ç”¨ HTML è§„åˆ™è§£æï¼›é‡åˆ°ä»£ç å—ï¼ˆä»¥ `{` å¼€å¤´ï¼‰ï¼Œå°±ç”¨ JavaScript è§„åˆ™è§£æã€‚

![img](https://www.ruanyifeng.com/blogimg/asset/2015/bg2015033106.png)

#### JSXä¸­ä¼šå±•å¼€æ•°ç»„

JSX å…è®¸ç›´æ¥åœ¨æ¨¡æ¿æ’å…¥ JavaScript å˜é‡ã€‚å¦‚æœè¿™ä¸ªå˜é‡æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåˆ™ä¼šå±•å¼€è¿™ä¸ªæ•°ç»„çš„æ‰€æœ‰æˆå‘˜ï¼ˆæŸ¥çœ‹ [`demo03`](https://github.com/ruanyf/react-demos/blob/master/demo03/index.html) ï¼‰ã€‚

> ```javascript
> var arr = [
>   <h1>Hello world!</h1>,
>   <h2>React is awesome</h2>,
> ];
> ReactDOM.render(
>   <div>{arr}</div>,
>   document.getElementById('example')
> );
> ```

ä¸Šé¢ä»£ç çš„`arr`å˜é‡æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œç»“æœ JSX ä¼šæŠŠå®ƒçš„æ‰€æœ‰æˆå‘˜ï¼Œæ·»åŠ åˆ°æ¨¡æ¿ã€‚

![img](https://www.ruanyifeng.com/blogimg/asset/2015/bg2015033107.png)

# Reacté¢å‘ç»„ä»¶ç¼–ç¨‹

## ç»„ä»¶

#### â€œç»„ä»¶ç±»â€

React å…è®¸å°†ä»£ç å°è£…æˆç»„ä»¶ï¼ˆcomponentï¼‰ï¼Œç„¶ååƒæ’å…¥æ™®é€š HTML æ ‡ç­¾ä¸€æ ·ï¼Œåœ¨ç½‘é¡µä¸­æ’å…¥è¿™ä¸ªç»„ä»¶ã€‚`React.createClass` æ–¹æ³•å°±ç”¨äºç”Ÿæˆä¸€ä¸ªç»„ä»¶ç±»ï¼ˆæŸ¥çœ‹ [`demo04`](https://github.com/ruanyf/react-demos/blob/master/demo04/index.html)ï¼‰ã€‚

> æ—§ç‰ˆæœ¬
>
> ```jsx
> var HelloMessage = React.createClass({
>   render: function() {
>     return <h1>Hello {this.props.name}</h1>;
>   }
> });
> 
> ReactDOM.render(
>   <HelloMessage name="John" />,
>   document.getElementById('example')
> );
> ```

> æ–°ç‰ˆæœ¬
>
> ```jsx
> class HelloMessage extends React.Component{
>     render(){
>         return <h1>Hello {this.props.name}</h1>;
>     }
> }
> ```
>
> ç»„ä»¶â€œç±»â€

ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡ `HelloMessage` å°±æ˜¯ä¸€ä¸ªç»„ä»¶ç±»ã€‚æ¨¡æ¿æ’å…¥ `<HelloMessage />` æ—¶ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆ `HelloMessage` çš„ä¸€ä¸ªå®ä¾‹ï¼ˆä¸‹æ–‡çš„"ç»„ä»¶"éƒ½æŒ‡ç»„ä»¶ç±»çš„å®ä¾‹ï¼‰

> â€œè‡ªåŠ¨ç”Ÿæˆç»„ä»¶ç±»çš„ä¸€ä¸ªå®ä¾‹â€è¿™ä¸ªæ¦‚å¿µå¥½åƒä¹‹å‰æ²¡å¬è§è¿‡ï¼å­¦ä¹ äº†ï¼

#### ç»„ä»¶ç±»ä½¿ç”¨renderæ–¹æ³•è¾“å‡ºç»„ä»¶

æ‰€æœ‰ç»„ä»¶ç±»éƒ½å¿…é¡»æœ‰è‡ªå·±çš„ `render` æ–¹æ³•ï¼Œç”¨äºè¾“å‡ºç»„ä»¶ã€‚

æ³¨æ„ï¼Œç»„ä»¶ç±»çš„ç¬¬ä¸€ä¸ªå­—æ¯å¿…é¡»å¤§å†™ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼Œæ¯”å¦‚`HelloMessage`ä¸èƒ½å†™æˆ`helloMessage`ã€‚

> å¦å¤–ï¼Œç»„ä»¶ç±»åªèƒ½åŒ…å«ä¸€ä¸ªé¡¶å±‚æ ‡ç­¾ï¼Œå¦åˆ™ä¹Ÿä¼šæŠ¥é”™ã€‚
>
> > ```jsx
> > var HelloMessage = React.createClass({
> >   render: function() {
> >     return <h1>
> >       Hello {this.props.name}
> >     </h1><p>
> >       some text
> >     </p>;
> >   }
> > });
> > ```
>
> ä¸Šé¢ä»£ç ä¼šæŠ¥é”™ï¼Œå› ä¸º`HelloMessage`ç»„ä»¶åŒ…å«äº†ä¸¤ä¸ªé¡¶å±‚æ ‡ç­¾ï¼š`h1`å’Œ`p`ã€‚

#### ç»„ä»¶å®ä¾‹ä»ç»„ä»¶ç±»çš„`this.props`å¯¹è±¡è·å–å±æ€§

ç»„ä»¶çš„ç”¨æ³•ä¸åŸç”Ÿçš„ HTML æ ‡ç­¾å®Œå…¨ä¸€è‡´ï¼Œå¯ä»¥ä»»æ„åŠ å…¥å±æ€§ï¼Œæ¯”å¦‚ `<HelloMessage name="John">` ï¼Œå°±æ˜¯ `HelloMessage` ç»„ä»¶åŠ å…¥ä¸€ä¸ª `name` å±æ€§ï¼Œå€¼ä¸º `John`ã€‚ç»„ä»¶çš„å±æ€§å¯ä»¥**åœ¨ç»„ä»¶ç±»çš„ `this.props` å¯¹è±¡ä¸Šè·å–**ï¼Œæ¯”å¦‚ `name` å±æ€§å°±å¯ä»¥é€šè¿‡ `this.props.name` è¯»å–ã€‚

#### ç»„ä»¶å±æ€§åçš„æ³¨æ„ç‚¹

æ·»åŠ ç»„ä»¶å±æ€§ï¼Œæœ‰ä¸€ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼Œå°±æ˜¯ `class` å±æ€§éœ€è¦å†™æˆ `className` ï¼Œ`for` å±æ€§éœ€è¦å†™æˆ `htmlFor` ï¼Œè¿™æ˜¯å› ä¸º `class` å’Œ `for` æ˜¯ JavaScript çš„ä¿ç•™å­—ã€‚

## Props

#### `this.props.children`-ç»„ä»¶æ‰€æœ‰å­èŠ‚ç‚¹

`this.props` å¯¹è±¡çš„å±æ€§ä¸ç»„ä»¶çš„å±æ€§ä¸€ä¸€å¯¹åº”ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªä¾‹å¤–ï¼Œå°±æ˜¯ `this.props.children` å±æ€§ã€‚å®ƒè¡¨ç¤ºç»„ä»¶çš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼ˆæŸ¥çœ‹ [`demo05`](https://github.com/ruanyf/react-demos/blob/master/demo05/index.html)ï¼‰ã€‚

> æ—§ç‰ˆæœ¬
>
> ```jsx
> var NotesList = React.createClass({
>   render: function() {
>     return (
>       <ol>
>       {
>         React.Children.map(this.props.children, function (child) {
>           return <li>{child}</li>;
>         })
>       }
>       </ol>
>     );
>   }
> });
> 
> ReactDOM.render(
>   <NotesList>
>     <span>hello</span>
>     <span>world</span>
>   </NotesList>,
>   document.body
> );
> ```

> æ–°ç‰ˆæœ¬
>
> ```jsx
> class NotesList extends React.Component{
>     render(){
>         return (
>         	<ol>
>             	{
>                     React.Children.map(this.props.children, function(child){
>                         return <li>{child}</li>
>                     })
>                 }
>             </ol>
>         )
>     }
> }
> ```



ä¸Šé¢ä»£ç çš„ `NoteList` ç»„ä»¶æœ‰ä¸¤ä¸ª `span` å­èŠ‚ç‚¹ï¼Œå®ƒä»¬éƒ½å¯ä»¥é€šè¿‡ `this.props.children` è¯»å–ï¼Œè¿è¡Œç»“æœå¦‚ä¸‹ã€‚

![img](https://www.ruanyifeng.com/blogimg/asset/2015/bg2015033110.png)

#### ç”¨`React.Children.map`éå†å­èŠ‚ç‚¹

è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œ `this.props.children` çš„å€¼æœ‰ä¸‰ç§å¯èƒ½ï¼š

- å¦‚æœå½“å‰ç»„ä»¶æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œå®ƒå°±æ˜¯ `undefined` ;
- å¦‚æœæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œæ•°æ®ç±»å‹æ˜¯ `object` ï¼›
- å¦‚æœæœ‰å¤šä¸ªå­èŠ‚ç‚¹ï¼Œæ•°æ®ç±»å‹å°±æ˜¯ `array` ã€‚

æ‰€ä»¥ï¼Œå¤„ç† `this.props.children` çš„æ—¶å€™è¦å°å¿ƒã€‚

React æä¾›ä¸€ä¸ªå·¥å…·æ–¹æ³• [`React.Children-ä¸­æ–‡æ–‡æ¡£`](https://zh-hans.reactjs.org/docs/react-api.html#reactchildren) æ¥å¤„ç† `this.props.children` ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ `React.Children.map` æ¥éå†å­èŠ‚ç‚¹ï¼Œè€Œä¸ç”¨æ‹…å¿ƒ `this.props.children` çš„æ•°æ®ç±»å‹æ˜¯ `undefined` è¿˜æ˜¯ `object`ã€‚æ›´å¤šçš„ `React.Children` çš„æ–¹æ³•ï¼Œè¯·å‚è€ƒ[å®˜æ–¹æ–‡æ¡£-è‹±æ–‡åŸç‰ˆ](https://reactjs.org/docs/react-api.html#reactchildren)ã€‚



#### `PropTypes`-éªŒè¯ä½¿ç”¨ç»„ä»¶æ—¶æä¾›çš„å‚æ•°æ˜¯å¦ç¬¦åˆè¦æ±‚

> è€ç‰ˆæœ¬ä¸­é˜®å¤§ä½¿ç”¨ `const Com React.createClass`åˆ›å»ºç»„ä»¶ï¼Œä¸æˆ‘ä¹‹å‰å­¦åˆ°çš„ï¼ˆæ›´æ¥è¿‘ES6è§„èŒƒçš„classå†™æ³•ï¼‰`class Com extends React.Component` ä¸å¤ªä¸€æ ·ï¼Œä¸”ä¸€äº›åœ°æ–¹çš„ç”¨æ³•ä¹Ÿä¸åŒ
>
> å¯ä»¥çœ‹çœ‹[è¿™ç¯‡æ–‡ç« ](https://www.cnblogs.com/fightjianxian/p/12350499.html)æ‰€é˜è¿°çš„è¿™ä¸¤è€…ä¹‹é—´çš„åŒºåˆ«
>
> ```jsx
>     1ã€è¯­æ³•åŒºåˆ«
>     2ã€propType å’Œ getDefaultProps
>     3ã€çŠ¶æ€çš„åŒºåˆ«
>     4ã€thisåŒºåˆ«
>     5ã€Mixins
> ```

ç»„ä»¶çš„å±æ€§å¯ä»¥æ¥å—ä»»æ„å€¼ï¼Œå­—ç¬¦ä¸²ã€å¯¹è±¡ã€å‡½æ•°ç­‰ç­‰éƒ½å¯ä»¥ã€‚æœ‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æœºåˆ¶ï¼ŒéªŒè¯åˆ«äººä½¿ç”¨ç»„ä»¶æ—¶ï¼Œæä¾›çš„å‚æ•°æ˜¯å¦ç¬¦åˆè¦æ±‚ã€‚

ç»„ä»¶ç±»çš„`PropTypes`å±æ€§ï¼Œå°±æ˜¯ç”¨æ¥éªŒè¯ç»„ä»¶å®ä¾‹çš„å±æ€§æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼ˆæŸ¥çœ‹ [`demo06`](https://github.com/ruanyf/react-demos/blob/master/demo06/index.html)ï¼‰ã€‚

> è€ç‰ˆæœ¬
>
> é€šè¿‡`proTypes`å¯¹è±¡å’Œ`getDefaultProps()`æ–¹æ³•æ¥è®¾ç½®å’Œè·å–`props`.
>
> ```jsx
> var MyTitle = React.createClass({
>     propTypes: {
>         title:React.PropTypes.string.isRequired,
>     },
>     render: function(){
>         return <h1>{this.props.title}</h1>
>     }
> })
> ```

> æ–°ç‰ˆæœ¬
>
> é€šè¿‡è®¾ç½®ä¸¤ä¸ªå±æ€§`propTypes`å’Œ`defaultProps`
>
> ```jsx
> class MyTitle extends React.Component{
>     //  æ”¹ä¸ºå±æ€§
>     static propTypes = {
>         title: PropType.string.isRequired,
>     }
> 	render(){
>         return <h1> {this.props.title} </h1>;
>     }
> }
> ```
>
> 

ä¸Šé¢çš„`Mytitle`ç»„ä»¶æœ‰ä¸€ä¸ª`title`å±æ€§ã€‚`PropTypes` å‘Šè¯‰ Reactï¼Œè¿™ä¸ª `title` å±æ€§æ˜¯å¿…é¡»çš„ï¼Œ**è€Œä¸”å®ƒçš„å€¼å¿…é¡»æ˜¯å­—ç¬¦ä¸²**ã€‚

ä¸¾ä¸ªåä¾‹æ¥æµ‹è¯•ä¸‹

è®¾ç½® `title` å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªæ•°å€¼ã€‚

> ```jsx
> var data = 123;
> 
> ReactDOM.render(
>   <MyTitle title={data} />,
>   document.body
> );
> ```

è¿™æ ·ä¸€æ¥ï¼Œ`title`å±æ€§å°±é€šä¸è¿‡éªŒè¯äº†ã€‚æ§åˆ¶å°ä¼šæ˜¾ç¤ºä¸€è¡Œé”™è¯¯ä¿¡æ¯ã€‚

> ```bash
> Warning: Failed propType: Invalid prop `title` of type `number` supplied to `MyTitle`, expected `string`.
> ```

æ›´å¤šçš„`PropTypes`è®¾ç½®ï¼Œå¯ä»¥æŸ¥çœ‹[å®˜æ–¹æ–‡æ¡£](https://zh-hans.reactjs.org/docs/typechecking-with-proptypes.html#gatsby-focus-wrapper)ã€‚



> [ä¹‹å‰åœ¨fccä¸­å­¦ä¹ åˆ°çš„ å®šä¹‰Propsç±»å‹](https://chinese.freecodecamp.org/learn/front-end-development-libraries/react/use-proptypes-to-define-the-props-you-expect)æ˜¯åœ¨ç»„ä»¶ç±»ä¹‹å¤–
>
> ä¸Šé¢å­¦ä¹ åˆ°çš„ç›´æ¥åœ¨ç»„ä»¶ç±»é‡Œé¢å®šä¹‰ä¹Ÿå¾ˆæ˜¯ç®€å•ï¼
>
> ```js
> class ShoppingCart extends React.Component {
>     constructor(porps){
>         super(props);
>     }
>     render(){
>         return <Items />
>     }
> }
> const Items = (porps) => {
>     return <h1>Current Quantity of Items in Cart:{props.quantity}</h1>
> }
> // è¿™é‡Œå®šä¹‰ propTypes å±æ€§ éªŒè¯ç»„ä»¶æ˜¯å¦æ¥æ”¶äº†æ­£ç¡®ç±»å‹çš„ props
> Items.propTypes = {quantity:PropTypes.number.isRequired};
> ```

#### `getDefaultProps`-è®¾ç½®ç»„ä»¶å±æ€§çš„é»˜è®¤å€¼



> æ—§ç‰ˆæœ¬
>
> ```jsx
> var MyTitle = React.createClass({
>   getDefaultProps : function () {
>     return {
>       title : 'Hello World'
>     };
>   },
> 
>   render: function() {
>      return <h1> {this.props.title} </h1>;
>    }
> });
> 
> ReactDOM.render(
>   <MyTitle />,
>   document.body
> );
> ```

> æ–°ç‰ˆæœ¬
>
> ```jsx
> class MyTitle extends React.Component{
>     static defaultProps = { 
>         // as static property
>         title: 'Hello World'
>     };
>     render(){
>         return <h1>{this.props.title}</h1>
>     }
> }
> ```

ä¸Šé¢ä»£ç ä¼šè¾“å‡º"Hello World"ã€‚

## State

#### ç»„ä»¶ä¸ç”¨æˆ·çš„äº’åŠ¨-`this.state`

React çš„ä¸€å¤§åˆ›æ–°ï¼Œå°±æ˜¯å°†ç»„ä»¶çœ‹æˆæ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œä¸€å¼€å§‹æœ‰ä¸€ä¸ªåˆå§‹çŠ¶æ€ï¼Œç„¶åç”¨æˆ·äº’åŠ¨ï¼Œå¯¼è‡´çŠ¶æ€å˜åŒ–ï¼Œä»è€Œè§¦å‘é‡æ–°æ¸²æŸ“ UI ï¼ˆæŸ¥çœ‹ [`demo08`](https://github.com/ruanyf/react-demos/blob/master/demo08/index.html) ï¼‰ã€‚

> æ—§ç‰ˆæœ¬
>
> ```jsx
> var LikeButton = React.createClass({
>   /*getInitialState: function() {
>     return {liked: false};
>   },*/
>   handleClick: function(event) {
>     this.setState({liked: !this.state.liked});
>   },
>   render: function() {
>     var text = this.state.liked ? 'like' : 'haven\'t liked';
>     return (
>       <p onClick={this.handleClick}>
>         You {text} this. Click to toggle.
>       </p>
>     );
>   }
> });
> 
> ReactDOM.render(
>   <LikeButton />,
>   document.getElementById('example')
> );
> ```

> æ–°ç‰ˆæœ¬
>
> ```jsx
> class LikeButton extends React.Component{
>     /*constructor(props){
>         super(props);
>         this.state = {
>             liked : false
>         }
>         this.handleClick = this.handleClick.bind(this);// æ—¶åˆ»è®°ä½è¦ç»‘å®šè¿™ä¸ªæ–¹æ³•
>     }*/
>     handleClick(event){
>         this.setState({
>             liked: !this.state.liked;
>         })
>     }
>     render(){
> 		var text = this.state.liked ? 'like' : 'haven\'t liked';
>         return(
>             <p onClick={this.handleClick}>
>         		You {text} this.Click to toggle
>         	</p>
>         )
>     }
> }
> ```



ä¸Šé¢ä»£ç æ˜¯ä¸€ä¸ª `LikeButton` ç»„ä»¶ï¼Œ

> å®ƒçš„ `getInitialState` æ–¹æ³•ç”¨äºå®šä¹‰â€”â€”
>
> - åˆå§‹çŠ¶æ€state(**æ–°ç‰ˆæœ¬ä¸­ä½¿ç”¨æ„é€ å‡½æ•°æ¥å®šä¹‰state**)ï¼Œä¹Ÿå°±æ˜¯**ä¸€ä¸ªå¯¹è±¡**ï¼Œè¿™ä¸ªå¯¹è±¡<u>å¯ä»¥é€šè¿‡ `this.state` å±æ€§è¯»å–</u>ã€‚

å½“ç”¨æˆ·ç‚¹å‡»ç»„ä»¶ï¼Œå¯¼è‡´çŠ¶æ€å˜åŒ–ï¼Œ`this.setState` æ–¹æ³•å°±ä¿®æ”¹çŠ¶æ€å€¼ï¼Œæ¯æ¬¡ä¿®æ”¹ä»¥åï¼Œ**è‡ªåŠ¨è°ƒç”¨ `this.render` æ–¹æ³•**ï¼Œå†æ¬¡æ¸²æŸ“ç»„ä»¶ã€‚

#### åŒºåˆ†propsä¸state

ç”±äº `this.props` å’Œ `this.state` éƒ½ç”¨äºæè¿°ç»„ä»¶çš„ç‰¹æ€§ï¼Œå¯èƒ½ä¼šäº§ç”Ÿæ··æ·†ã€‚

ä¸€ä¸ªç®€å•çš„åŒºåˆ†æ–¹æ³•æ˜¯ï¼š

- `this.props` è¡¨ç¤ºé‚£äº›ä¸€æ—¦å®šä¹‰ï¼Œå°±ä¸å†æ”¹å˜çš„ç‰¹æ€§
- è€Œ `this.state` æ˜¯ä¼šéšç€ç”¨æˆ·äº’åŠ¨è€Œäº§ç”Ÿå˜åŒ–çš„ç‰¹æ€§ã€‚

[å®˜æ–¹æ–‡æ¡£](https://react.docschina.org/docs/faq-state.html#what-is-the-difference-between-state-and-props)æ˜¯è¿™ä¹ˆè¯´çš„ï¼š

> propsï¼ˆâ€œpropertiesâ€ çš„ç¼©å†™ï¼‰å’Œ state éƒ½æ˜¯**æ™®é€šçš„ JavaScript å¯¹è±¡**ã€‚
> å®ƒä»¬éƒ½æ˜¯**ç”¨æ¥ä¿å­˜ä¿¡æ¯**çš„ï¼Œè¿™äº›ä¿¡æ¯å¯ä»¥æ§åˆ¶ç»„ä»¶çš„æ¸²æŸ“è¾“å‡ºï¼Œè€Œå®ƒä»¬çš„ä¸€ä¸ªé‡è¦çš„ä¸åŒç‚¹å°±æ˜¯ï¼š
>
> - props æ˜¯**ä¼ é€’ç»™ç»„ä»¶**çš„ï¼ˆç±»ä¼¼äºå‡½æ•°çš„å½¢å‚ï¼‰
> - è€Œ state æ˜¯**åœ¨ç»„ä»¶å†…è¢«ç»„ä»¶è‡ªå·±ç®¡ç†çš„**ï¼ˆç±»ä¼¼äºåœ¨ä¸€ä¸ªå‡½æ•°å†…å£°æ˜çš„å˜é‡ï¼‰

> å®˜æ–¹æ¨èé˜…è¯»ææ–™
>
> - [Props vs State](https://github.com/uberVU/react-guide/blob/master/props-vs-state.md)
> - [ReactJS: Props vs. State](https://lucybain.com/blog/2016/react-state-vs-pros/)

## [Refs](https://zh-hans.reactjs.org/docs/refs-and-the-dom.html)

Refs æä¾›äº†ä¸€ç§æ–¹å¼ï¼Œå…è®¸æˆ‘ä»¬**è®¿é—® DOM èŠ‚ç‚¹æˆ–åœ¨ render æ–¹æ³•ä¸­åˆ›å»ºçš„ React å…ƒç´ **ã€‚

åœ¨å…¸å‹çš„ React æ•°æ®æµä¸­ï¼Œ[props](https://zh-hans.reactjs.org/docs/components-and-props.html) æ˜¯çˆ¶ç»„ä»¶ä¸å­ç»„ä»¶äº¤äº’çš„å”¯ä¸€æ–¹å¼ã€‚è¦ä¿®æ”¹ä¸€ä¸ªå­ç»„ä»¶ï¼Œä½ éœ€è¦ä½¿ç”¨æ–°çš„ props æ¥é‡æ–°æ¸²æŸ“å®ƒã€‚

ä½†æ˜¯ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ éœ€è¦åœ¨å…¸å‹æ•°æ®æµä¹‹å¤–å¼ºåˆ¶ä¿®æ”¹å­ç»„ä»¶ã€‚è¢«ä¿®æ”¹çš„å­ç»„ä»¶å¯èƒ½æ˜¯ä¸€ä¸ª React ç»„ä»¶çš„å®ä¾‹ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ª DOM å…ƒç´ ã€‚å¯¹äºè¿™ä¸¤ç§æƒ…å†µï¼ŒReact éƒ½æä¾›äº†è§£å†³åŠæ³•ã€‚

#### ä½•æ—¶ä½¿ç”¨ Refs

ä¸‹é¢æ˜¯å‡ ä¸ªé€‚åˆä½¿ç”¨ refs çš„æƒ…å†µï¼š

- ç®¡ç†ç„¦ç‚¹ï¼Œæ–‡æœ¬é€‰æ‹©æˆ–åª’ä½“æ’­æ”¾ã€‚
- è§¦å‘å¼ºåˆ¶åŠ¨ç”»ã€‚
- é›†æˆç¬¬ä¸‰æ–¹ DOM åº“ã€‚

é¿å…ä½¿ç”¨ refs æ¥åšä»»ä½•å¯ä»¥é€šè¿‡å£°æ˜å¼å®ç°æ¥å®Œæˆçš„äº‹æƒ…ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œé¿å…åœ¨ `Dialog` ç»„ä»¶é‡Œæš´éœ² `open()` å’Œ `close()` æ–¹æ³•ï¼Œæœ€å¥½ä¼ é€’ `isOpen` å±æ€§ã€‚

#### å‹¿è¿‡åº¦ä½¿ç”¨ Refs

ä½ å¯èƒ½é¦–å…ˆä¼šæƒ³åˆ°ä½¿ç”¨ refs åœ¨ä½ çš„ app ä¸­â€œè®©äº‹æƒ…å‘ç”Ÿâ€ã€‚å¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼Œè¯·èŠ±ä¸€ç‚¹æ—¶é—´ï¼Œè®¤çœŸå†è€ƒè™‘ä¸€ä¸‹ state å±æ€§åº”è¯¥è¢«å®‰æ’åœ¨å“ªä¸ªç»„ä»¶å±‚ä¸­ã€‚é€šå¸¸ä½ ä¼šæƒ³æ˜ç™½ï¼Œè®©æ›´é«˜çš„ç»„ä»¶å±‚çº§æ‹¥æœ‰è¿™ä¸ª stateï¼Œæ˜¯æ›´æ°å½“çš„ã€‚æŸ¥çœ‹ [çŠ¶æ€æå‡](https://zh-hans.reactjs.org/docs/lifting-state-up.html) ä»¥è·å–æ›´å¤šæœ‰å…³ç¤ºä¾‹ã€‚

#### å®ä¾‹-åˆ›å»º Refs

Refs æ˜¯ä½¿ç”¨ `React.createRef()` åˆ›å»ºçš„ï¼Œå¹¶é€šè¿‡ `ref` å±æ€§é™„åŠ åˆ° React å…ƒç´ ã€‚åœ¨æ„é€ ç»„ä»¶æ—¶ï¼Œé€šå¸¸å°† Refs åˆ†é…ç»™å®ä¾‹å±æ€§ï¼Œä»¥ä¾¿å¯ä»¥åœ¨æ•´ä¸ªç»„ä»¶ä¸­å¼•ç”¨å®ƒä»¬ã€‚

```jsx
class MyComponent extends React.Component {
  constructor(props) {
    super(props);
    this.myRef = React.createRef();  }
  render() {
    return <div ref={this.myRef} />;  }
}
```

#### è®¿é—® Refs

å½“ ref è¢«ä¼ é€’ç»™ `render` ä¸­çš„å…ƒç´ æ—¶ï¼Œ<u>å¯¹è¯¥èŠ‚ç‚¹çš„å¼•ç”¨å¯ä»¥åœ¨ ref çš„ `current` å±æ€§ä¸­è¢«è®¿é—®ã€‚</u>

```jsx
const node = this.myRef.current;
```

ref çš„å€¼æ ¹æ®èŠ‚ç‚¹çš„ç±»å‹è€Œæœ‰æ‰€ä¸åŒï¼š

- å½“ `ref` å±æ€§ç”¨äº HTML å…ƒç´ æ—¶ï¼Œæ„é€ å‡½æ•°ä¸­ä½¿ç”¨ `React.createRef()` åˆ›å»ºçš„ `ref` æ¥æ”¶åº•å±‚ DOM å…ƒç´ ä½œä¸ºå…¶ `current` å±æ€§ã€‚
- å½“ `ref` å±æ€§ç”¨äºè‡ªå®šä¹‰ class ç»„ä»¶æ—¶ï¼Œ`ref` å¯¹è±¡æ¥æ”¶ç»„ä»¶çš„æŒ‚è½½å®ä¾‹ä½œä¸ºå…¶ `current` å±æ€§ã€‚
- **ä½ ä¸èƒ½åœ¨å‡½æ•°ç»„ä»¶ä¸Šä½¿ç”¨ `ref` å±æ€§**ï¼Œå› ä¸ºä»–ä»¬æ²¡æœ‰å®ä¾‹ã€‚

#### å®ä¾‹-å°†è™šæ‹ŸDOMæ’å…¥æ–‡æ¡£ï¼Œè·å–çœŸå®DOM

ç»„ä»¶å¹¶ä¸æ˜¯çœŸå®çš„ DOM èŠ‚ç‚¹ï¼Œè€Œæ˜¯å­˜åœ¨äºå†…å­˜ä¹‹ä¸­çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œå«åšè™šæ‹Ÿ DOM ï¼ˆvirtual DOMï¼‰ã€‚åªæœ‰å½“å®ƒæ’å…¥æ–‡æ¡£ä»¥åï¼Œæ‰ä¼šå˜æˆçœŸå®çš„ DOM ã€‚

æ ¹æ® React çš„è®¾è®¡ï¼Œ**æ‰€æœ‰çš„ DOM å˜åŠ¨ï¼Œéƒ½å…ˆåœ¨è™šæ‹Ÿ DOM ä¸Šå‘ç”Ÿï¼Œç„¶åå†å°†å®é™…å‘ç”Ÿå˜åŠ¨çš„éƒ¨åˆ†ï¼Œåæ˜ åœ¨çœŸå® DOMä¸Š**ï¼Œè¿™ç§ç®—æ³•å«åš [DOM diff](https://zh-hans.reactjs.org/docs/reconciliation.html#the-diffing-algorithm) ï¼Œå®ƒå¯ä»¥æå¤§æé«˜ç½‘é¡µçš„æ€§èƒ½è¡¨ç°ã€‚

ä½†æ˜¯ï¼Œæœ‰æ—¶éœ€è¦ä»ç»„ä»¶è·å–çœŸå® DOM çš„èŠ‚ç‚¹ï¼Œè¿™æ—¶å°±è¦ç”¨åˆ° `ref` å±æ€§ï¼ˆæŸ¥çœ‹ [demo07](https://github.com/ruanyf/react-demos/blob/master/demo07/index.html) ï¼‰ã€‚

> æ—§ç‰ˆæœ¬
>
> ```jsx
> var MyComponent = React.createClass({
>     handleClick: function(){
>         this.refs.myTextInput.focus();
>     }
>     render: function() {
>     	return (
>           <div>
>             <input type="text" ref="myTextInput" />
>             <input type="button" value="Focus the text input" onClick={this.handleClick} />
>           </div>
>         );
>       }
> })
> ```
>
> éœ€è¦æ³¨æ„ï¼Œæœ¬ä¾‹ä¸­æåˆ°çš„[å­—ç¬¦å‹çš„refå±æ€§å·²ç»è¿‡æ—¶äº†](https://zh-hans.reactjs.org/docs/refs-and-the-dom.html#legacy-api-string-refs)ï¼ï¼ˆä¸»è¦æ˜¯å› ä¸ºæ•ˆç‡ä¸é«˜+å­˜åœ¨[ä¸€äº›é—®é¢˜](https://github.com/facebook/react/pull/8333#issuecomment-271648615)ï¼‰
>
> ä¸è¿‡ç”¨è¿™ä¸ªçš„ç¨‹åºå‘˜å¯èƒ½è¿˜æŒºå¤š å› ä¸ºæ¯”è¾ƒç®€å•çœäº‹å„¿~
>
> ä¸¥è°¨èµ·è§ï¼Œå»ºè®®ä½¿ç”¨ä¸‹é¢æ–°ç‰ˆæœ¬ä¸­çš„[å›è°ƒå‡½æ•°æ–¹å¼](https://zh-hans.reactjs.org/docs/refs-and-the-dom.html#caveats-with-callback-refs)ï¼

> [æ–°ç‰ˆæœ¬](https://github.com/ruanyf/react-demos/blob/master/demo07/index.html)
>
> ä½¿ç”¨äº†[`React.createRef`](https://zh-hans.reactjs.org/docs/react-api.html#reactcreateref)ï¼Œåˆ›å»ºä¸€ä¸ªèƒ½å¤Ÿé€šè¿‡refå±æ€§é™„åŠ åˆ° React å…ƒç´ çš„ [ref](https://zh-hans.reactjs.org/docs/refs-and-the-dom.html)ã€‚
>
> ```jsx
> class MyComponent extends React.Component{
>     constructor(props){
>         super(props);
>         this.myTextInput = React.createRef();// myTextInputå°±æ˜¯åˆ›å»ºçš„Refs
>         this.handleClick = this.handleClick.bind(this);// ç»‘å®šç‚¹å‡»äº‹ä»¶
>     }
>     handleClick(){
>         //  ç‚¹å‡»äº‹ä»¶çš„å›è°ƒå‡½æ•°ï¼Œä½œç”¨ï¼šåœ¨ç‚¹å‡»æŒ‰é’®ä¹‹åå¯¹â€œrenderä¸­çš„å…ƒç´ â€è¿›è¡Œèšç„¦
>         this.myTextInput.current.focus();
>     }
>     render(){
>         return(
>             <div>
>                 {/* å°†refä¼ ç»™renderä¸­çš„å…ƒç´ ï¼Œå¯¹è¯¥èŠ‚ç‚¹ï¼ˆinputè¾“å…¥æ¡†ï¼‰çš„å¼•ç”¨å¯ä»¥åœ¨refçš„currentå±æ€§ä¸­è®¿é—®ï¼è§ä¸Šé¢ç¬¬9è¡Œçš„ä»£ç  */}
>                 <input type="text" ref={this.myTextInput} /> 
>                 <input type="button" value="Focus te text input" onClick={this.handleClick} />
>             </div>
>         )
>     }
>     
> }
> ```

ä¸Šé¢ä»£ç ä¸­ï¼Œç»„ä»¶ `MyComponent` çš„å­èŠ‚ç‚¹æœ‰ä¸€ä¸ªæ–‡æœ¬è¾“å…¥æ¡†ï¼Œç”¨äºè·å–ç”¨æˆ·çš„è¾“å…¥ã€‚è¿™æ—¶å°±å¿…é¡»**è·å–çœŸå®çš„ DOM èŠ‚ç‚¹**ï¼Œè™šæ‹Ÿ DOM æ˜¯æ‹¿ä¸åˆ°ç”¨æˆ·è¾“å…¥çš„ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ–‡æœ¬è¾“å…¥æ¡†å¿…é¡»æœ‰ä¸€ä¸ª `ref` å±æ€§ï¼Œç„¶å `this.refs.[refName]` å°±ä¼šè¿”å›è¿™ä¸ªçœŸå®çš„ DOM èŠ‚ç‚¹ã€‚

![image-20211026114118072](https://gitee.com/su-fangzhou/blog-image/raw/master/202110261141127.png)

> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº `this.refs.[refName]` å±æ€§**è·å–çš„æ˜¯çœŸå® DOM** ï¼Œæ‰€ä»¥å¿…é¡»ç­‰åˆ°è™šæ‹Ÿ DOM æ’å…¥æ–‡æ¡£ä»¥åï¼Œæ‰èƒ½ä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚
>
> ä¸Šé¢ä»£ç ä¸­ï¼Œé€šè¿‡ä¸ºç»„ä»¶æŒ‡å®š `Click` äº‹ä»¶çš„å›è°ƒå‡½æ•°ï¼Œç¡®ä¿äº†åªæœ‰ç­‰åˆ°çœŸå® DOM å‘ç”Ÿ `Click` äº‹ä»¶ä¹‹åï¼Œæ‰ä¼šè¯»å– `this.refs.[refName]` å±æ€§ã€‚
>
> React ç»„ä»¶æ”¯æŒå¾ˆå¤šäº‹ä»¶ï¼Œé™¤äº† `Click` äº‹ä»¶ä»¥å¤–ï¼Œè¿˜æœ‰ `KeyDown` ã€`Copy`ã€`Scroll` ç­‰ï¼Œå®Œæ•´çš„äº‹ä»¶æ¸…å•è¯·æŸ¥çœ‹[å®˜æ–¹æ–‡æ¡£](https://facebook.github.io/react/docs/events.html#supported-events)ã€‚



## è¡¨å•

#### Reactä¸­è¡¨å•å…ƒç´ &DOMå…ƒç´ æœ‰äº›ä¸åŒï¼

åœ¨ React é‡Œï¼ŒHTML è¡¨å•å…ƒç´ çš„å·¥ä½œæ–¹å¼å’Œå…¶ä»–çš„ DOM å…ƒç´ æœ‰äº›ä¸åŒï¼Œè¿™æ˜¯å› ä¸ºè¡¨å•å…ƒç´ é€šå¸¸ä¼šä¿æŒä¸€äº›å†…éƒ¨çš„ stateã€‚ä¾‹å¦‚è¿™ä¸ªçº¯ HTML è¡¨å•åªæ¥å—ä¸€ä¸ªåç§°ï¼š

```html
<form>
  <label>
    åå­—:
    <input type="text" name="name" />
  </label>
  <input type="submit" value="æäº¤" />
</form>
```

æ­¤è¡¨å•å…·æœ‰é»˜è®¤çš„ HTML è¡¨å•è¡Œä¸ºï¼Œå³åœ¨ç”¨æˆ·æäº¤è¡¨å•åæµè§ˆåˆ°æ–°é¡µé¢ã€‚å¦‚æœä½ åœ¨ React ä¸­æ‰§è¡Œç›¸åŒçš„ä»£ç ï¼Œå®ƒä¾ç„¶æœ‰æ•ˆã€‚ä½†å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½¿ç”¨ JavaScript å‡½æ•°å¯ä»¥å¾ˆæ–¹ä¾¿çš„å¤„ç†è¡¨å•çš„æäº¤ï¼Œ åŒæ—¶è¿˜å¯ä»¥è®¿é—®ç”¨æˆ·å¡«å†™çš„è¡¨å•æ•°æ®ã€‚å®ç°è¿™ç§æ•ˆæœçš„æ ‡å‡†æ–¹å¼æ˜¯ä½¿ç”¨â€œå—æ§ç»„ä»¶â€ã€‚





#### ä½¿ç”¨**å—æ§ç»„ä»¶**è®¿é—®ç”¨æˆ·å¡«å†™çš„è¡¨å•æ•°æ®

> [å—æ§ç»„ä»¶çš„æ¦‚å¿µ](https://react.docschina.org/docs/forms.html#controlled-components)ï¼š
>
> - åœ¨ HTML ä¸­ï¼Œè¡¨å•å…ƒç´ ï¼ˆå¦‚`<input>`ã€ `<textarea>` å’Œ `<select>`ï¼‰ä¹‹ç±»çš„è¡¨å•å…ƒç´ é€šå¸¸è‡ªå·±ç»´æŠ¤ çŠ¶æ€ï¼Œå¹¶æ ¹æ®ç”¨æˆ·è¾“å…¥è¿›è¡Œæ›´æ–°ã€‚
> - è€Œåœ¨ React ä¸­ï¼Œå¯å˜çŠ¶æ€ï¼ˆmutable stateï¼‰é€šå¸¸ä¿å­˜åœ¨ç»„ä»¶çš„ state å±æ€§ä¸­ï¼Œå¹¶ä¸”åªèƒ½é€šè¿‡ä½¿ç”¨ [`setState()`](https://react.docschina.org/docs/react-component.html#setstate)æ¥æ›´æ–°ã€‚
>
> æŠŠä¸¤è€…ç»“åˆèµ·æ¥ï¼Œä½¿reactå¾—stateæˆä¸ºâ€œå”¯ä¸€æ•°æ®æºâ€ï¼›æ¸²æŸ“è¡¨å•çš„ React ç»„ä»¶è¿˜æ§åˆ¶ç€ç”¨æˆ·è¾“å…¥è¿‡ç¨‹ä¸­è¡¨å•å‘ç”Ÿçš„æ“ä½œã€‚
>
> è¢«React**ä»¥è¿™ç§æ–¹å¼æ§åˆ¶ï¼ˆç”¨`setState()`æ›´æ–°è¡¨å•å±æ€§å€¼ï¼‰**å–å€¼å¾—è¡¨å•è¾“å…¥å…ƒç´ å°±å«åšâ€”â€”**å—æ§ç»„ä»¶**

ç”¨æˆ·åœ¨è¡¨å•å¡«å…¥çš„å†…å®¹ï¼Œå±äºç”¨æˆ·è·Ÿç»„ä»¶çš„äº’åŠ¨ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨ `this.props` è¯»å–ï¼ˆæŸ¥çœ‹ [`demo9`](https://github.com/ruanyf/react-demos/blob/master/demo09/index.html) ï¼‰ã€‚

> æ—§ç‰ˆæœ¬
>
> æ²¡æœ‰æ„é€ å‡½æ•°çœ‹èµ·æ¥é›€æ°æœ‰ç‚¹æ€ªå“ˆ
>
> ```jsx
> var Input = React.createClass({
>   getInitialState: function() {
>     return {value: 'Hello!'};
>   },
>   handleChange: function(event) {
>     this.setState({value: event.target.value});
>   },
>   render: function () {
>     var value = this.state.value;
>     return (
>       <div>
>         <input type="text" value={value} onChange={this.handleChange} />
>         <p>{value}</p>
>       </div>
>     );
>   }
> });
> 
> ReactDOM.render(<Input/>, document.body);
> ```

> æ–°ç‰ˆæœ¬
>
> è¿™é‡Œæˆ‘ç¨å¾®æ”¹äº†ä¸€ä¸‹stateä¸­å±æ€§çš„å˜é‡åï¼ŒåŸæ¥çš„è·Ÿ`event.target.value`ä¸­çš„valueé‡å äº†æœ‰ç‚¹éš¾å—XD
>
> ```jsx
> class Input extends React.Component {
>     constructor(props) {
>         super(props)
>         this.state = {
>             slogan: 'Hi!This is bill~'
>         }
>         this.handleChange = this.handleChange.bind(this)
>     }
>     handleChange(event) {
>         this.setState({ slogan: event.target.value });
>     }
>     render() {
>         var slogan = this.state.slogan;
>         return (
>             <div>
>                 <input type="text" value={slogan} onChange={this.handleChange} />
>                 <p>{slogan}</p>
>             </div>
>         );
>     }
> }
> 
> ReactDOM.render(<Input/>, document.getElementById('example'));
> ```
>
> > æˆ‘ä»¬é€šè¿‡`event.target.value`æ¥è¯»å–ç”¨æˆ·è¾“å…¥çš„å€¼ï¼Œå¹¶ç”¨è¿™ä¸ªå€¼æ›´æ–°ç»„ä»¶stateä¸­çš„å¯¹åº”å±æ€§(value)

ä¸Šé¢ä»£ç ä¸­ï¼Œæ–‡æœ¬è¾“å…¥æ¡†çš„å€¼ï¼Œä¸èƒ½ç”¨ `this.props.value` è¯»å–ï¼Œè€Œè¦å®šä¹‰ä¸€ä¸ª `onChange` äº‹ä»¶çš„å›è°ƒå‡½æ•°ï¼Œ**é€šè¿‡ `event.target.value` è¯»å–ç”¨æˆ·è¾“å…¥çš„å€¼**ã€‚

`textarea` å…ƒç´ ã€`select`å…ƒç´ ã€`radio`å…ƒç´ éƒ½å±äºè¿™ç§æƒ…å†µï¼Œæ›´å¤šä»‹ç»è¯·å‚è€ƒ[å®˜æ–¹æ–‡æ¡£](https://facebook.github.io/react/docs/forms.html)ã€‚

- å°ç»“

å—æ§ç»„ä»¶ä½¿ç”¨stateæ¥å­˜æ•°æ®ï¼Œåˆ›å»º**å›è°ƒå‡½æ•°**å¹¶ä½¿ç”¨`setState({æ•°æ®:event.target.value})`æ¥æ›´æ–°æ•°æ®ï¼Œåœ¨è¡¨å•ä¸­ä½¿ç”¨äº‹ä»¶ç›‘å¬å¹¶è°ƒç”¨å›è°ƒå‡½æ•°ã€‚

#### å—æ§ç»„ä»¶çš„æ›¿ä»£å“-éå—æ§ç»„ä»¶

æœ‰æ—¶ä½¿ç”¨å—æ§ç»„ä»¶ä¼šå¾ˆéº»çƒ¦ï¼Œå› ä¸ºä½ éœ€è¦ä¸º**æ•°æ®å˜åŒ–çš„æ¯ç§æ–¹å¼**éƒ½ç¼–å†™äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªReactç»„ä»¶ä¼ é€’æ‰€æœ‰çš„è¾“å…¥stateã€‚

å½“ä½ å°†ä¹‹å‰çš„ä»£ç åº“è½¬æ¢ä¸º React æˆ–å°† React åº”ç”¨ç¨‹åºä¸é React åº“é›†æˆæ—¶ï¼Œè¿™å¯èƒ½ä¼šä»¤äººåŒçƒ¦ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½å¸Œæœ›ä½¿ç”¨[éå—æ§ç»„ä»¶](https://react.docschina.org/docs/uncontrolled-components.html), è¿™æ˜¯å®ç°è¾“å…¥è¡¨å•çš„å¦ä¸€ç§æ–¹å¼ã€‚

> [éå—æ§ç»„ä»¶](https://react.docschina.org/docs/uncontrolled-components.html)
>
> åœ¨<u>å¤§å¤šæ•°æƒ…å†µ</u>ä¸‹ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨ [å—æ§ç»„ä»¶](https://react.docschina.org/docs/forms.html#controlled-components) æ¥å¤„ç†è¡¨å•æ•°æ®ã€‚åœ¨ä¸€ä¸ªå—æ§ç»„ä»¶ä¸­ï¼Œè¡¨å•æ•°æ®æ˜¯ç”± React ç»„ä»¶æ¥ç®¡ç†çš„ã€‚å¦ä¸€ç§æ›¿ä»£æ–¹æ¡ˆæ˜¯ä½¿ç”¨éå—æ§ç»„ä»¶ï¼Œè¿™æ—¶è¡¨å•æ•°æ®å°†**äº¤ç”± DOM èŠ‚ç‚¹æ¥å¤„ç†**ã€‚

æœ‰æœ¨æœ‰å¾ˆè€³ç†Ÿï¼Ÿè®¿é—®DOMèŠ‚ç‚¹æ¥è·å–è¡¨å•æ•°æ®ï¼Ÿ

![image-20211027111800991](https://gitee.com/su-fangzhou/blog-image/raw/master/202110271118065.png)

> è¦ç¼–å†™ä¸€ä¸ªéå—æ§ç»„ä»¶ï¼Œè€Œä¸æ˜¯ä¸ºæ¯ä¸ªçŠ¶æ€æ›´æ–°éƒ½ç¼–å†™æ•°æ®å¤„ç†å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ [ä½¿ç”¨ ref](https://react.docschina.org/docs/refs-and-the-dom.html) æ¥ä» DOM èŠ‚ç‚¹ä¸­è·å–è¡¨å•æ•°æ®ã€‚



## ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ

#### ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„ç®€å•ç†è§£

- ç»„ä»¶ä»åˆ›å»ºåˆ°æ­»äº¡å®ƒä¼šç»å†ä¸€äº›ç‰¹å®šçš„é˜¶æ®µã€‚
- Reactç»„ä»¶ä¸­åŒ…å«ä¸€ç³»åˆ—å‹¾å­å‡½æ•°(ç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°), ä¼š**åœ¨ç‰¹å®šçš„æ—¶åˆ»è°ƒç”¨**ã€‚
- æˆ‘ä»¬åœ¨å®šä¹‰ç»„ä»¶æ—¶ï¼Œä¼šåœ¨ç‰¹å®šçš„ç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°ä¸­ï¼Œåšç‰¹å®šçš„å·¥ä½œã€‚

ç»„ä»¶çš„[ç”Ÿå‘½å‘¨æœŸ](https://facebook.github.io/react/docs/working-with-the-browser.html#component-lifecycle)åˆ†æˆä¸‰ä¸ªçŠ¶æ€ï¼š

> - Mountingï¼šå·²æ’å…¥çœŸå® DOM
> - Updatingï¼šæ­£åœ¨è¢«é‡æ–°æ¸²æŸ“
> - Unmountingï¼šå·²ç§»å‡ºçœŸå® DOM

React ä¸ºæ¯ä¸ªçŠ¶æ€éƒ½æä¾›äº†å¤„ç†å‡½æ•°ï¼Œ

- `will` å‡½æ•°åœ¨è¿›å…¥çŠ¶æ€ä¹‹å‰è°ƒç”¨
- `did` å‡½æ•°åœ¨è¿›å…¥çŠ¶æ€ä¹‹åè°ƒç”¨
- `unmount`å‡½æ•°åœ¨ç»“æŸçŠ¶æ€æ—¶è°ƒç”¨ï¼Œåšä¸€äº›æ”¶å°¾å·¥ä½œ

ä¸‰ç§çŠ¶æ€å…±è®¡äº”ç§å¤„ç†å‡½æ•°ï¼ˆé’©å­å‡½æ•° å³ä¸ºç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°ï¼‰ã€‚

> - `componentWillMount()` Ã—
> - `componentDidMount()`  âˆš
> - `componentWillUpdate(object nextProps, object nextState)` Ã—
> - `componentDidUpdate(object prevProps, object prevState)`
> - `componentWillUnmount()` âˆš

æ­¤å¤–ï¼ŒReact è¿˜æä¾›ä¸¤ç§ç‰¹æ®ŠçŠ¶æ€çš„å¤„ç†å‡½æ•°ã€‚

> - `componentWillReceiveProps(object nextProps)`ï¼šå·²åŠ è½½ç»„ä»¶æ”¶åˆ°æ–°çš„å‚æ•°æ—¶è°ƒç”¨
> - `shouldComponentUpdate(object nextProps, object nextState)`ï¼šç»„ä»¶åˆ¤æ–­æ˜¯å¦é‡æ–°æ¸²æŸ“æ—¶è°ƒç”¨

è¿™äº›æ–¹æ³•çš„è¯¦ç»†è¯´æ˜ï¼Œå¯ä»¥å‚è€ƒ[å®˜æ–¹æ–‡æ¡£](https://facebook.github.io/react/docs/component-specs.html#lifecycle-methods)ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼ˆæŸ¥çœ‹ [`demo10`](https://github.com/ruanyf/react-demos/blob/master/demo10/index.html) ï¼‰ã€‚

> æ—§ç‰ˆæœ¬
>
> ```jsx
> var Hello = React.createClass({
>   getInitialState: function () {
>     return {
>       opacity: 1.0
>     };
>   },
> 
>   componentDidMount: function () {
>     this.timer = setInterval(function () {
>       var opacity = this.state.opacity;
>       opacity -= .05;
>       if (opacity < 0.1) {
>         opacity = 1.0;
>       }
>       this.setState({
>         opacity: opacity
>       });
>     }.bind(this), 100);
>   },
> 
>   render: function () {
>     return (
>       <div style={{opacity: this.state.opacity}}>
>         Hello {this.props.name}
>       </div>
>     );
>   }
> });
> 
> ReactDOM.render(
>   <Hello name="world"/>,
>   document.body
> );
> ```

> æ–°ç‰ˆæœ¬
>
> ```jsx
> class Hello extends React.Component{
>     constructor(props){
>         super(props);
>         this.state = {
>             opacity: 1
>         }
>     }
>     componentDidMount(){
>         // åœ¨è¿™ä¸ªé’©å­å‡½æ•°ä¸­ä¸€èˆ¬ä¼šè¿›è¡Œä¸€äº›åˆå§‹åŒ–çš„äº‹
>         this.timer = setInterval(function(){
>             var opacity = this.state.opacity;
>             opacity -= 0.05;
>             if(opacity < 0.1){
>                 opacity = 1.0;
>             }
>             this.setState({
>                 opacity: opacity
>             })
>         }.bind(this), 100);// æ¯éš”0.1ç§’ å°†é€æ˜åº¦å‡å°‘0.05ï¼Œå¹¶ä½¿ç”¨setStateæ›´æ–°opacityé€æ˜åº¦
>     }
>     render(){
>         return(
>             <div style = {{opacity: this.state.opacity}}>Hello {this.props.name}!</div>
>         );
>     }
> }
> ```

ä¸Šé¢ä»£ç åœ¨`hello`ç»„ä»¶åŠ è½½ä»¥åï¼Œé€šè¿‡ `componentDidMount` æ–¹æ³•è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œæ¯éš”100æ¯«ç§’ï¼Œå°±é‡æ–°è®¾ç½®ç»„ä»¶çš„é€æ˜åº¦ï¼Œä»è€Œå¼•å‘é‡æ–°æ¸²æŸ“ã€‚

å¦å¤–ï¼Œç»„ä»¶çš„`style`å±æ€§çš„è®¾ç½®æ–¹å¼ä¹Ÿå€¼å¾—æ³¨æ„ï¼Œä¸èƒ½å†™æˆ

> ```jsx
> style="opacity:{this.state.opacity};"
> ```

è€Œè¦å†™æˆ

> ```jsx
> style={{opacity: this.state.opacity}}
> ```

è¿™æ˜¯å› ä¸º **React ç»„ä»¶æ ·å¼**æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥ç¬¬ä¸€é‡å¤§æ‹¬å·è¡¨ç¤ºè¿™æ˜¯ JavaScript è¯­æ³•ï¼Œç¬¬äºŒé‡å¤§æ‹¬å·è¡¨ç¤ºæ ·å¼å¯¹è±¡ã€‚



#### é‡è¦çš„ç”Ÿå‘½å‘¨æœŸé’©å­&å³å°†åºŸå¼ƒçš„é’©å­

##### é‡è¦ï¼ˆå¸¸ç”¨çš„ï¼‰

- `render`ï¼šåˆå§‹åŒ–æ¸²æŸ“æˆ–æ›´æ–°æ¸²æŸ“è°ƒç”¨
- `componentDidMount`ï¼šç”¨äºåœ¨é¡µé¢ä¸€ä¸Šæ¥å°±è¿›è¡Œçš„ä¸€äº›æ“ä½œï¼Œä¸€èˆ¬åœ¨è¿™ä¸ªé’©å­é‡Œåšä¸€äº›**åˆå§‹åŒ–**çš„äº‹ã€‚æ¯”å¦‚å¼€å¯ç›‘å¬ã€å¼€å¯å®šæ—¶å™¨ã€ ç”¨æ¥å‘é€ajaxè¯·æ±‚
- `componentWillUnmount`ï¼šåšä¸€äº›æ”¶å°¾å·¥ä½œ, å¦‚: æ¸…ç†å®šæ—¶å™¨

##### å³å°†åºŸå¼ƒ

- `componentWillMount`
- `componentWillReceiveProps`
- `componentWillUpdate`



#### ç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾ï¼ˆæ—§ï¼‰&ç”Ÿå‘½å‘¨æœŸä¸‰ä¸ªé˜¶æ®µ

![image-20211027113050692](https://gitee.com/su-fangzhou/blog-image/raw/master/202110271130754.png)

ã€1ã€‘`ReactDOM.render()`è§¦å‘---åˆæ¬¡æ¸²æŸ“

- constructor()
- `componentWillMount()`ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¼šåœ¨ç‰ˆæœ¬ 16.X åºŸå¼ƒåœ¨ç‰ˆæœ¬ 17 ç§»é™¤
- render()â€”â€”å¸¸ç”¨ï¼ˆè¿™è‚¯å®šï¼‰
- `componentDidMount()` â€”â€” **å¸¸ç”¨** 
  - ç”¨äºåœ¨é¡µé¢ä¸€ä¸Šæ¥å°±è¿›è¡Œçš„ä¸€äº›æ“ä½œï¼Œä¸€èˆ¬åœ¨è¿™ä¸ªé’©å­é‡Œåšä¸€äº›åˆå§‹åŒ–çš„äº‹ æ¯”å¦‚ï¼š
    - å¼€å¯å®šæ—¶å™¨
    - å‘é€ç½‘ç»œè¯·æ±‚
    - è®¢é˜…æ¶ˆæ¯
  - ã€æ¥è‡ª`freecodecamp`ã€‘æŸäº›æ—¶å€™ï¼Œå¤§å¤šæ•° web å¼€å‘äººå‘˜éœ€è¦è°ƒç”¨ API æ¥å£æ¥è·å–æ•°æ®ã€‚ å¦‚æœæ­£åœ¨ä½¿ç”¨ Reactï¼ŒçŸ¥é“åœ¨å“ªé‡Œæ‰§è¡Œè¿™ä¸ªåŠ¨ä½œæ˜¯å¾ˆé‡è¦çš„ã€‚æ‰€ä»¥[React çš„æœ€ä½³å®è·µæ˜¯åœ¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³• `componentDidMount()` ä¸­å¯¹æœåŠ¡å™¨è¿›è¡Œ API è°ƒç”¨æˆ–ä»»ä½•å…¶å®ƒè°ƒç”¨](https://chinese.freecodecamp.org/learn/front-end-development-libraries/react/use-the-lifecycle-method-componentdidmount)ã€‚ å°†ç»„ä»¶è£…è½½åˆ°DOM åä¼šè°ƒç”¨æ­¤ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚
    - æ­¤å¤„å¯¹ `setState()` çš„ä»»ä½•è°ƒç”¨éƒ½å°†è§¦å‘ç»„ä»¶çš„**é‡æ–°æ¸²æŸ“**ã€‚ åœ¨æ­¤æ–¹æ³•ä¸­è°ƒç”¨ API å¹¶ç”¨ API è¿”å›çš„æ•°æ®è®¾ç½® state æ—¶ï¼Œä¸€æ—¦æ”¶åˆ°æ•°æ®ï¼Œå®ƒå°†è‡ªåŠ¨è§¦å‘æ›´æ–°ã€‚

ã€2ã€‘ç”±ç»„ä»¶å†…éƒ¨`this.setSate()`æˆ–çˆ¶ç»„ä»¶ä»`render`è§¦å‘ â€”æ›´æ–°é˜¶æ®µ

å…¶å®å°±æ˜¯ä¸Šé¢æœ€åä¸€ç‚¹è¯´çš„ â€œå¯¹`setState`çš„ä»»ä½•è°ƒç”¨éƒ½ä¼šè§¦å‘ç»„ä»¶çš„**é‡æ–°æ¸²æŸ“**ï¼ˆå³ä¸ºæ›´æ–°ï¼‰â€

- `shouldComponentUpdate()`
- `componentWillUpdate()` - å³å°†åºŸå¼ƒ
- `render()`
- `componentDidUpdate()`

ã€3ã€‘ç”±`ReactDOM.unmountComponentAtNode()`è§¦å‘ â€” å¸è½½ç»„ä»¶

- `componentWillUnmount()` â€”â€”å¸¸ç”¨  ä¸€èˆ¬åœ¨è¿™ä¸ªé’©å­ä¸­åšä¸€äº›æ”¶å°¾çš„äº‹æƒ… ä¾‹å¦‚ï¼š
  -  å…³é—­å®šæ—¶å™¨
  - å–æ¶ˆè®¢é˜…æ¶ˆæ¯

#### ç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾ï¼ˆæ–°ï¼‰&æ–°ç”Ÿå‘½å‘¨æœŸçš„ä¸‰ä¸ªé˜¶æ®µ

![image-20211027144203366](https://gitee.com/su-fangzhou/blog-image/raw/master/202110271442430.png)

ã€1ã€‘`ReactDOM.render()`è§¦å‘---åˆæ¬¡æ¸²æŸ“

- constructor()
- `componentWillMount()`ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¼šåœ¨ç‰ˆæœ¬ 16.X åºŸå¼ƒåœ¨ç‰ˆæœ¬ 17 ç§»é™¤
- render()â€”â€”å¸¸ç”¨ï¼ˆè¿™è‚¯å®šï¼‰
- `componentDidMount()` â€”â€” **å¸¸ç”¨** ï¼Œå¥½æ¯”â€œäººåˆšå‡ºç”Ÿâ€

æ–°å¢ï¼š

- `getDerivedStateFromProps`

ã€2ã€‘ç”±ç»„ä»¶å†…éƒ¨`this.setSate()`æˆ–çˆ¶ç»„ä»¶ä»`render`è§¦å‘ â€”æ›´æ–°é˜¶æ®µ

- `shouldComponentUpdate()`
- ~~`componentWillUpdate()`~~- åºŸå¼ƒ
- `render()`
- `componentDidUpdate()`

æ–°å¢ï¼š

- `getDerivedStateFromProps`
- `getSnapshotBeforeUpdate`



ã€3ã€‘ç”±`ReactDOM.unmountComponentAtNode()`è§¦å‘ â€” å¸è½½ç»„ä»¶

- `componentWillUnmount()` â€”â€”**å¸¸ç”¨**ï¼Œå¥½æ¯”â€œäººçš„å¯¿å‘½èµ°å‘ç»ˆç‚¹â€





## è™šæ‹ŸDOMä¸DOM Diffingç®—æ³•

[Diffing ç®—æ³•](https://zh-hans.reactjs.org/docs/reconciliation.html#the-diffing-algorithm)









# React Ajax

## Ajax

#### é€šè¿‡Ajaxè¯·æ±‚ä»æœåŠ¡å™¨è·å–æ•°æ®å¹¶ä¼ å…¥ç»„ä»¶

ç»„ä»¶çš„æ•°æ®æ¥æºï¼Œé€šå¸¸æ˜¯é€šè¿‡ Ajax è¯·æ±‚ä»æœåŠ¡å™¨è·å–ï¼Œå¯ä»¥ä½¿ç”¨ `componentDidMount` æ–¹æ³•è®¾ç½® Ajax è¯·æ±‚ï¼Œç­‰åˆ°è¯·æ±‚æˆåŠŸï¼Œå†ç”¨ `this.setState` æ–¹æ³•é‡æ–°æ¸²æŸ“ UI ï¼ˆæŸ¥çœ‹ [`demo11`](https://github.com/ruanyf/react-demos/blob/master/demo11/index.html) ï¼‰ã€‚

> æ—§ç‰ˆæœ¬
>
> ```jsx
> var UserGist = React.createClass({
>   getInitialState: function() {
>     return {
>       username: '',
>       lastGistUrl: ''
>     };
>   },
> 
>   componentDidMount: function() {
>     $.get(this.props.source, function(result) {
>       var lastGist = result[0];
>       if (this.isMounted()) {
>         this.setState({
>           username: lastGist.owner.login,
>           lastGistUrl: lastGist.html_url
>         });
>       }
>     }.bind(this));
>   },
> 
>   render: function() {
>     return (
>       <div>
>         {this.state.username}'s last gist is
>         <a href={this.state.lastGistUrl}>here</a>.
>       </div>
>     );
>   }
> });
> 
> ReactDOM.render(
>   <UserGist source="https://api.github.com/users/octocat/gists" />,
>   document.body
> );
> ```

> æ–°ç‰ˆæœ¬
>
> ```jsx
> class UserGist extends React.Component {
>     constructor(props) {
>         super(props)
>         this.state = {
>             username: '',
>             lastGistUrl: ''
>         }
>     }
>     componentDidMount(){
>         $.get(this.props.source, function(result){
>             var lastGist = result[0];
>             this.setState({
>                 username: lastGist.owner.login,
>                 lastGistUrl: lastGist.html_url
>             });
>         }.bind(this));
>     }
>     render(){
> 		return(
>             <div>
>                 {this.state.username}'s last gist is <a href={this.state.lastGistUrl}>here</a>.
>         	</div>
>         );
>     }
> }
> ReactDOM.render(
>     <UserGist source="https://api.github.com/users/octocat/gists" />,
>     document.getElementById('example')
> );
> ```

ä¸Šé¢ä»£ç ä½¿ç”¨ jQuery å®Œæˆ Ajax è¯·æ±‚ï¼Œè¿™æ˜¯ä¸ºäº†ä¾¿äºè¯´æ˜ã€‚React æœ¬èº«æ²¡æœ‰ä»»ä½•ä¾èµ–ï¼Œå®Œå…¨å¯ä»¥ä¸ç”¨jQueryï¼Œè€Œä½¿ç”¨å…¶ä»–åº“ã€‚

#### å°†promiseå¯¹è±¡ä¼ å…¥ç»„ä»¶

æˆ‘ä»¬ç”šè‡³å¯ä»¥æŠŠä¸€ä¸ªPromiseå¯¹è±¡ä¼ å…¥ç»„ä»¶ï¼Œè¯·çœ‹[`Demo12`](https://github.com/ruanyf/react-demos/blob/master/demo12/index.html)ã€‚

> ```jsx
> ReactDOM.render(
>   <RepoList
>     promise={$.getJSON('https://api.github.com/search/repositories?q=javascript&sort=stars')}
>   />,
>   document.body
> );
> ```

ä¸Šé¢ä»£ç ä»`Github`çš„APIæŠ“å–æ•°æ®ï¼Œç„¶åå°†Promiseå¯¹è±¡ä½œä¸ºå±æ€§ï¼Œä¼ ç»™`RepoList`ç»„ä»¶ã€‚

å¦‚æœPromiseå¯¹è±¡æ­£åœ¨æŠ“å–æ•°æ®ï¼ˆpendingçŠ¶æ€ï¼‰ï¼Œç»„ä»¶æ˜¾ç¤º"æ­£åœ¨åŠ è½½"ï¼›

å¦‚æœPromiseå¯¹è±¡æŠ¥é”™ï¼ˆrejectedçŠ¶æ€ï¼‰ï¼Œç»„ä»¶æ˜¾ç¤ºæŠ¥é”™ä¿¡æ¯ï¼›

å¦‚æœPromiseå¯¹è±¡æŠ“å–æ•°æ®æˆåŠŸï¼ˆfulfilledçŠ¶æ€ï¼‰ï¼Œç»„ä»¶æ˜¾ç¤ºè·å–çš„æ•°æ®ã€‚

```jsx
class RepoList extends React.Component {
    constructor(props) {
        super(props)
        this.state = {
            loading: true,
            error: null,
            data: null
        };
    }

    componentDidMount() {
        this.props.promise.then(
            value => this.setState({loading: false, data: value}),
            error => this.setState({loading: false, error: error}));
    }

    render() {
        // è¯·æ±‚ä¸­
        if (this.state.loading) {
            return <span>Loading...</span>;
        }
        // è¯·æ±‚å¤±è´¥
        else if (this.state.error !== null) {
            return <span>Error: {this.state.error.message}</span>;
        }
        // q
        else {
            var repos = this.state.data.items;
            var repoList = repos.map(function (repo, index) {
                return (
                    <li key={index}><a href={repo.html_url}>{repo.name}</a> ({repo.stargazers_count} stars) <br/> {repo.description}</li>
                );
            });
            return (
                <main>
                    <h1>Most Popular JavaScript Projects in Github</h1>
                    <ol>{repoList}</ol>
                </main>
            );
        }
    }
}
```

- è¯·æ±‚ä¸­

![image-20211027160808722](https://gitee.com/su-fangzhou/blog-image/raw/master/202110271608804.png)

- è¯·æ±‚å¤±è´¥

![image-20211027160738510](https://gitee.com/su-fangzhou/blog-image/raw/master/202110271607599.png)

- è¯·æ±‚æˆåŠŸ

![image-20211027160759180](https://gitee.com/su-fangzhou/blog-image/raw/master/202110271607299.png)



[æ–°æ‰‹å‘ï¼šVue 2.0 çš„å»ºè®®å­¦ä¹ é¡ºåº by é±¿é±¼æºª](https://zhuanlan.zhihu.com/p/23134551)

# VueåŸºç¡€ç¯‡(Guide)

> é€šè¯»å®˜æ–¹æ•™ç¨‹ (guide) çš„åŸºç¡€ç¯‡ã€‚ä¸è¦ç”¨ä»»ä½•æ„å»ºå·¥å…·ï¼Œå°±åªç”¨æœ€ç®€å•çš„ `<script>`ï¼ŒæŠŠæ•™ç¨‹é‡Œçš„ä¾‹å­æ¨¡ä»¿ä¸€éï¼Œç†è§£ç”¨æ³•ã€‚**ä¸æ¨èä¸Šæ¥å°±ç›´æ¥ç”¨ vue-cli æ„å»ºé¡¹ç›®ï¼Œå°¤å…¶æ˜¯å¦‚æœæ²¡æœ‰ Node/Webpack åŸºç¡€ã€‚**

## Vue.jsä»‹ç»

[Vueçš„å®˜æ–¹æ–‡æ¡£](https://cn.vuejs.org/v2/guide/)ï¼ˆä¸­æ–‡ï¼‰æ¯”Reactï¼ˆä¸­æ–‡ï¼‰è¦å‹å¥½å¾ˆå¤šå‘ï¼

- å…¨é¢
- æ›´æµåˆ©è‡ªç„¶çš„ä¸­æ–‡
- ä¾‹å­ç³»ç»Ÿä¸”å¾ªåºæ¸è¿›





## Vueå®ä¾‹

### æ•°æ®ä¸æ–¹æ³•

```html
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title></title>
<script src="vue.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
<div id="app">
	{{msg}}
	<p>Using mustaches: {{ rawHtml }}</p>
	<p v-html="rawHtml"></p>
	<div v-bind:class="color">test...</div>
	<p>{{ number + 1 }}</p>
	<p>{{ 1 == 1 ? 'YES' : 'NO' }}</p>
	<p>{{ message.split('').reverse().join('') }}</p>
</div>
<script type="text/javascript">
var vm = new Vue({
	el : "#app",
	data : {
		msg : "hi vue",
		rawHtml : '<span style="color:red">this is should be red</span>',
		color:'blue',
		number : 10,
		ok : 1,
		message : "vue"
	}
});
vm.msg = "hi....";
</script>
<style type="text/css">
    .red{color:red;}
    .blue{color:blue; font-size:100px;}
</style>
</body>
</html>
```

![image-20211028110823302](https://gitee.com/su-fangzhou/blog-image/raw/master/202110281108400.png)

### å®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸ

ä¸‹å›¾å±•ç¤ºäº†å®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸã€‚ä½ ä¸éœ€è¦ç«‹é©¬å¼„æ˜ç™½æ‰€æœ‰çš„ä¸œè¥¿ï¼Œä¸è¿‡éšç€ä½ çš„ä¸æ–­å­¦ä¹ å’Œä½¿ç”¨ï¼Œå®ƒçš„å‚è€ƒä»·å€¼ä¼šè¶Šæ¥è¶Šé«˜ã€‚

![Vue å®ä¾‹ç”Ÿå‘½å‘¨æœŸ](https://cn.vuejs.org/images/lifecycle.png)

## Vueæ¨¡æ¿è¯­æ³•

### [æ’å€¼](https://cn.vuejs.org/v2/guide/syntax.html#%E6%8F%92%E5%80%BC)



### [æŒ‡ä»¤](https://cn.vuejs.org/v2/guide/syntax.html#%E6%8C%87%E4%BB%A4)



## è®¡ç®—å±æ€§å’Œä¾¦å¬å™¨

### [è®¡ç®—å±æ€§ vs ä¾¦å¬å±æ€§](https://cn.vuejs.org/v2/guide/computed.html#è®¡ç®—å±æ€§-vs-ä¾¦å¬å±æ€§)

watchæ–¹æ³•ï¼š

> é”®æ˜¯éœ€è¦è§‚å¯Ÿçš„è¡¨è¾¾å¼ï¼Œå€¼æ˜¯å¯¹åº”å›è°ƒå‡½æ•°ã€‚å€¼ä¹Ÿå¯ä»¥æ˜¯æ–¹æ³•åï¼Œæˆ–è€…åŒ…å«é€‰é¡¹çš„å¯¹è±¡ã€‚Vue å®ä¾‹å°†ä¼šåœ¨å®ä¾‹åŒ–æ—¶è°ƒç”¨ $watch()ï¼Œéå† watch å¯¹è±¡çš„æ¯ä¸€ä¸ªå±æ€§ã€‚ 



## Classä¸Styleç»‘å®š



## æ¡ä»¶æ¸²æŸ“



## åˆ—è¡¨æ¸²æŸ“



## äº‹ä»¶å¤„ç†

- `v-on`



## è¡¨å•è¾“å…¥ç»‘å®š

- `v-model`

  - å¤é€‰æ¡†-ç»‘å®šå¸ƒå°”å€¼

  å¸ƒå°”å€¼è¿™é‡Œä¸€ä¸‹å­å¤ä¹ äº†ä¿©XD

  â€‹	inputä¸labelçš„ç»‘å®šé€šè¿‡ id ã€ forä¿©å±æ€§

  â€‹	å°†å¤é€‰æ¡†ç»‘å®šåˆ°å¸ƒå°”å€¼ é€šè¿‡å¤é€‰æ¡†çš„ v-modelçš„å±æ€§

  ![image-20211029084630158](https://gitee.com/su-fangzhou/blog-image/raw/master/202110290846298.png)

  - å•é€‰æŒ‰é’®-ç»‘å®šlabelä¸­çš„å€¼

  ![image-20211029085045829](https://gitee.com/su-fangzhou/blog-image/raw/master/202110290850026.png)

  - é€‰æ‹©æ¡†-ç»‘å®šoptionä¸­çš„å€¼

  ![image-20211029084956892](https://gitee.com/su-fangzhou/blog-image/raw/master/202110290849082.png)

  ![image-20211029085142080](https://gitee.com/su-fangzhou/blog-image/raw/master/202110290851220.png)



## ç»„ä»¶åŸºç¡€

- ç»„ä»¶åŸºç¡€ä½¿ç”¨

è¿™é‡Œæœ‰ä¸€ä¸ª Vue ç»„ä»¶çš„ç¤ºä¾‹ï¼š

```html
// å®šä¹‰ä¸€ä¸ªåä¸º button-counter çš„æ–°ç»„ä»¶
Vue.component('button-counter', {
  data: function () {
    return {
      count: 0
    }
  },
  template: '<button v-on:click="count++">You clicked me {{ count }} times.</button>'
})
```

ç»„ä»¶æ˜¯å¯å¤ç”¨çš„ Vue å®ä¾‹ï¼Œä¸”å¸¦æœ‰ä¸€ä¸ªåå­—ï¼šåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ `<button-counter>`ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªé€šè¿‡ `new Vue` åˆ›å»ºçš„ Vue æ ¹å®ä¾‹ä¸­ï¼ŒæŠŠè¿™ä¸ªç»„ä»¶ä½œä¸ºè‡ªå®šä¹‰å…ƒç´ æ¥ä½¿ç”¨ï¼š

```html
<div id="components-demo">
  <button-counter></button-counter>
</div>
new Vue({ el: '#components-demo' })
```

å› ä¸ºç»„ä»¶æ˜¯å¯å¤ç”¨çš„ Vue å®ä¾‹ï¼Œæ‰€ä»¥å®ƒä»¬ä¸ `new Vue` æ¥æ”¶ç›¸åŒçš„é€‰é¡¹ï¼Œä¾‹å¦‚ `data`ã€`computed`ã€`watch`ã€`methods` ä»¥åŠç”Ÿå‘½å‘¨æœŸé’©å­ç­‰ã€‚ä»…æœ‰çš„ä¾‹å¤–æ˜¯åƒ `el` è¿™æ ·æ ¹å®ä¾‹ç‰¹æœ‰çš„é€‰é¡¹ã€‚

### [ç»„ä»¶çš„å¤ç”¨](https://cn.vuejs.org/v2/guide/components.html#ç»„ä»¶çš„å¤ç”¨)

ä½ å¯ä»¥å°†ç»„ä»¶è¿›è¡Œä»»æ„æ¬¡æ•°çš„å¤ç”¨ï¼š

```html
<div id="components-demo">
  <button-counter></button-counter>
  <button-counter></button-counter>
  <button-counter></button-counter>
</div>
```

You clicked me 1 times. You clicked me 0 times. You clicked me 0 times.

æ³¨æ„å½“ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œæ¯ä¸ªç»„ä»¶éƒ½ä¼šå„è‡ªç‹¬ç«‹ç»´æŠ¤å®ƒçš„ `count`ã€‚å› ä¸ºä½ æ¯ç”¨ä¸€æ¬¡ç»„ä»¶ï¼Œå°±ä¼šæœ‰ä¸€ä¸ªå®ƒçš„æ–°**å®ä¾‹**è¢«åˆ›å»ºã€‚

### [`data` å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°](https://cn.vuejs.org/v2/guide/components.html#data-å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°)

> è¿™é‡ŒçœŸçš„æœ‰é“ç†å‘~
>
> è·Ÿreactçš„`render(){return ``}`åŒç†

å½“æˆ‘ä»¬å®šä¹‰è¿™ä¸ª `<button-counter>` ç»„ä»¶æ—¶ï¼Œä½ å¯èƒ½ä¼šå‘ç°å®ƒçš„ `data` å¹¶ä¸æ˜¯åƒè¿™æ ·ç›´æ¥æä¾›ä¸€ä¸ªå¯¹è±¡ï¼š

```js
data: {
  count: 0
}
```

å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œ**ä¸€ä¸ªç»„ä»¶çš„ `data` é€‰é¡¹å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°**ï¼Œå› æ­¤æ¯ä¸ªå®ä¾‹å¯ä»¥ç»´æŠ¤ä¸€ä»½è¢«è¿”å›å¯¹è±¡çš„ç‹¬ç«‹çš„æ‹·è´ï¼š

```js
data: function () {
  return {
    count: 0
  }
}
```

å¦‚æœ Vue æ²¡æœ‰è¿™æ¡è§„åˆ™ï¼Œç‚¹å‡»ä¸€ä¸ªæŒ‰é’®å°±å¯èƒ½å½±å“åˆ°*å…¶å®ƒæ‰€æœ‰å®ä¾‹*ï¼š

- ç»„ä»¶çš„ç»„ç»‡

é€šå¸¸ä¸€ä¸ªåº”ç”¨ä¼šä»¥ä¸€æ£µåµŒå¥—çš„ç»„ä»¶æ ‘çš„å½¢å¼æ¥ç»„ç»‡ï¼š

![Component Tree](https://cn.vuejs.org/images/components.png)

ä¾‹å¦‚ï¼Œä½ å¯èƒ½ä¼šæœ‰é¡µå¤´ã€ä¾§è¾¹æ ã€å†…å®¹åŒºç­‰ç»„ä»¶ï¼Œæ¯ä¸ªç»„ä»¶åˆåŒ…å«äº†å…¶å®ƒçš„åƒå¯¼èˆªé“¾æ¥ã€åšæ–‡ä¹‹ç±»çš„ç»„ä»¶ã€‚

ä¸ºäº†èƒ½åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ï¼Œè¿™äº›ç»„ä»¶å¿…é¡»å…ˆæ³¨å†Œä»¥ä¾¿ Vue èƒ½å¤Ÿè¯†åˆ«ã€‚è¿™é‡Œæœ‰ä¸¤ç§ç»„ä»¶çš„æ³¨å†Œç±»å‹ï¼š**å…¨å±€æ³¨å†Œ**å’Œ**å±€éƒ¨æ³¨å†Œ**ã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬çš„ç»„ä»¶éƒ½åªæ˜¯é€šè¿‡ `Vue.component` å…¨å±€æ³¨å†Œçš„ï¼š

```
Vue.component('my-component-name', {
  // ... options ...
})
```

å…¨å±€æ³¨å†Œçš„ç»„ä»¶å¯ä»¥ç”¨åœ¨å…¶è¢«æ³¨å†Œä¹‹åçš„ä»»ä½• (é€šè¿‡ `new Vue`) æ–°åˆ›å»ºçš„ Vue æ ¹å®ä¾‹ï¼Œä¹ŸåŒ…æ‹¬å…¶ç»„ä»¶æ ‘ä¸­çš„æ‰€æœ‰å­ç»„ä»¶çš„æ¨¡æ¿ä¸­ã€‚



- æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åœ¨ç»„ä»¶ä¸­ `v-bind` æ¥åŠ¨æ€ä¼ é€’ propã€‚è¿™åœ¨ä½ ä¸€å¼€å§‹ä¸æ¸…æ¥šè¦æ¸²æŸ“çš„å…·ä½“å†…å®¹ï¼Œæ¯”å¦‚[ä»ä¸€ä¸ª API è·å–åšæ–‡åˆ—è¡¨](https://codesandbox.io/s/github/vuejs/vuejs.org/tree/master/src/v2/examples/vue-20-component-blog-post-example)çš„æ—¶å€™ï¼Œæ˜¯éå¸¸æœ‰ç”¨çš„ã€‚

```js
Vue.component("blog-post", {
    props: ["title"],
    template: "<h3>{{ title }}</h3>"
});

var vm = new Vue({
    el: "#blog-post-demo",
    data: {
        posts: []
    },
    created: function() {
        // Alias the component instance as `vm`, so that we
        // can access it inside the promise function
        
        // Fetch our array of posts from an API
        fetch("https://jsonplaceholder.typicode.com/posts")
            .then(function(response) {
            return response.json();
        })
            .then(function(data) {
            vm.posts = data;
        });
    }
});
```

### åŠ¨æ€ç»„ä»¶

é€šè¿‡ Vue çš„ `<component>` å…ƒç´ åŠ ä¸€ä¸ªç‰¹æ®Šçš„ `is` attribute æ¥å®ç°ï¼š

```html
<!-- ç»„ä»¶ä¼šåœ¨ `currentTabComponent` æ”¹å˜æ—¶æ”¹å˜ -->
<component v-bind:is="currentTabComponent"></component>
```

åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œ`currentTabComponent` å¯ä»¥åŒ…æ‹¬

- å·²æ³¨å†Œç»„ä»¶çš„åå­—ï¼Œæˆ–
- ä¸€ä¸ªç»„ä»¶çš„é€‰é¡¹å¯¹è±¡

```html
<div id="dynamic-component-demo" class="demo">
    <button
            v-for="tab in tabs"
            v-bind:key="tab"
            v-bind:class="['tab-button', { active: currentTab === tab }]"
            v-on:click="currentTab = tab"
            >
        {{ tab }}
    </button>

    <!-- åŠ¨æ€ç»‘å®šç»„ä»¶ -->
    <component v-bind:is="currentTabComponent" class="tab"></component>
</div>

<script>
    Vue.component("tab-home", {
        template: "<div>Home component</div>"
    });
    Vue.component("tab-posts", {
        template: "<div>Posts component</div>"
    });
    Vue.component("tab-archive", {
        template: "<div>Archive component</div>"
    });

    new Vue({
        el: "#dynamic-component-demo",
        data: {
            currentTab: "Home",
            tabs: ["Home", "Posts", "Archive"]
        },
        computed: {
            currentTabComponent: function() {
                return "tab-" + this.currentTab.toLowerCase();
            }
        }
    });
</script>
```

