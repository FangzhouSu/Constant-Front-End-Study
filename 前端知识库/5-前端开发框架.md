> æ—¥åå·¥ä½œä¸­ä¸€ç›´è¦æ¥è§¦çš„å†…å®¹ å…¥è¡Œçš„æ ‡å‡†ğŸ§‘â€ğŸ’»

# React

å‚è€ƒå­¦ä¹ èµ„æº

- [é˜®å¤§çš„ Reactå…¥é—¨å®ä¾‹æ•™ç¨‹](https://www.ruanyifeng.com/blog/2015/03/react.html)
- [Reactå®˜ç½‘åŸºç¡€æ•™ç¨‹](https://react.docschina.org/docs/hello-world.html)
- Bç«™å°šç¡…è°·è¯¾ç¨‹

## ReactåŸºç¡€çŸ¥è¯†

#### HTMLæ¨¡æ¿

> ```jsx
> <!DOCTYPE html>
> <html>
>   <head>
>     <script src="../build/react.js"></script>
>     <script src="../build/react-dom.js"></script>
>     <script src="../build/browser.min.js"></script>
>   </head>
>   <body>
>     <div id="example"></div>
>     <script type="text/babel">
>       // ** Our code goes here! **
>     </script>
>   </body>
> </html>
> ```

 `<script>` æ ‡ç­¾çš„ `type` å±æ€§ä¸º `text/babel` ã€‚

è¿™æ˜¯å› ä¸º React ç‹¬æœ‰çš„ JSX è¯­æ³•ï¼Œè·Ÿ JavaScript ä¸å…¼å®¹ã€‚å‡¡æ˜¯ä½¿ç”¨ JSX çš„åœ°æ–¹ï¼Œéƒ½è¦åŠ ä¸Š `type="text/babel"` ã€‚

ä¸Šé¢ä»£ç ä¸€å…±ç”¨äº†ä¸‰ä¸ªåº“ï¼š `react.js` ã€`react-dom.js` å’Œ `Browser.js` ï¼Œå®ƒä»¬å¿…é¡»é¦–å…ˆåŠ è½½ã€‚å…¶ä¸­

- `react.js` æ˜¯ React çš„æ ¸å¿ƒåº“
- `react-dom.js` æ˜¯æä¾›ä¸ DOM ç›¸å…³çš„åŠŸèƒ½
- `Browser.js` çš„ä½œç”¨æ˜¯å°† JSX è¯­æ³•è½¬ä¸º JavaScript è¯­æ³•ï¼Œè¿™ä¸€æ­¥å¾ˆæ¶ˆè€—æ—¶é—´ï¼Œå®é™…ä¸Šçº¿çš„æ—¶å€™ï¼Œåº”è¯¥å°†å®ƒæ”¾åˆ°æœåŠ¡å™¨å®Œæˆã€‚

#### `ReactDOM.render()`

`ReactDOM.render` æ˜¯ React çš„æœ€åŸºæœ¬æ–¹æ³•ï¼Œç”¨äºå°†æ¨¡æ¿è½¬ä¸º HTML è¯­è¨€ï¼Œå¹¶æ’å…¥æŒ‡å®šçš„ DOM èŠ‚ç‚¹ã€‚

> ```jsx
> ReactDOM.render(
>   <h1>Hello, world!</h1>,
>   document.getElementById('example')
> );
> ```

ä¸Šé¢ä»£ç å°†ä¸€ä¸ª `h1` æ ‡é¢˜ï¼Œæ’å…¥ `example` èŠ‚ç‚¹ï¼ˆæŸ¥çœ‹ [`demo01`](https://github.com/ruanyf/react-demos/blob/master/demo01/index.html)ï¼‰ï¼Œè¿è¡Œç»“æœå¦‚ä¸‹ã€‚

![img](https://www.ruanyifeng.com/blogimg/asset/2015/bg2015033109.png)



## JSX

#### JSXè¯­æ³•

HTML è¯­è¨€ç›´æ¥å†™åœ¨ JavaScript è¯­è¨€ä¹‹ä¸­ï¼Œä¸åŠ ä»»ä½•å¼•å·ï¼Œè¿™å°±æ˜¯ [JSX çš„è¯­æ³•](https://facebook.github.io/react/docs/displaying-data.html#jsx-syntax)ï¼Œå®ƒå…è®¸ HTML ä¸ JavaScript çš„æ··å†™ï¼ˆæŸ¥çœ‹ [`Demo02`](https://github.com/ruanyf/react-demos/blob/master/demo02/index.html) ï¼‰ã€‚

> æ—§ç‰ˆæœ¬
>
> ```jsx
> var names = ['Alice', 'Emily', 'Kate'];
> 
> ReactDOM.render(
>   <div>
>   {
>     names.map(function (name) {
>       return <div>Hello, {name}!</div>
>     })
>   }
>   </div>,
>   document.getElementById('example')
> );
> ```

> æ–°ç‰ˆæœ¬
>
> æ¶‰åŠäº†keyçš„å†…å®¹
>
> > éœ€è¦æ³¨æ„ï¼å¦‚æœæ¶‰åŠåˆ°éå†åˆ—è¡¨çš„éœ€æ±‚ï¼Œkeyæœ€å¥½ä¸è¦ç”¨indexï¼
> >
> > ![image-20211026114735118](https://gitee.com/su-fangzhou/blog-image/raw/master/202110261147195.png)
> >
> > ![image-20211026114801860](https://gitee.com/su-fangzhou/blog-image/raw/master/202110261148929.png)
> >
> > å°ç»“ï¼šå¦‚æœä¸å­˜åœ¨å¯¹æ•°æ®çš„é€†åºæ·»åŠ ã€é€†åºåˆ é™¤ï¼Œä»…ä»…æ˜¯ä¸ºäº†æ¸²æŸ“åˆ—è¡¨ç”¨äºå±•ç¤ºï¼Œé‚£å°±å¯ä»¥ä½¿ç”¨indexä½œä¸ºkey
> >
> > ![image-20211026114904827](https://gitee.com/su-fangzhou/blog-image/raw/master/202110261149879.png)
>
> > å¼€å‘ä¸­å¦‚ä½•é€‰å–keyï¼Ÿ
> >
> > æœ‰å”¯ä¸€æ ‡è¯†å°½é‡è¿˜æ˜¯ç”¨å”¯ä¸€æ ‡è¯†ï¼
> >
> > ![image-20211026115023933](https://gitee.com/su-fangzhou/blog-image/raw/master/202110261150005.png)
>
> ```jsx
> ReactDOM.render(
>   <div>
>   {
>     names.map(function (name, index) {
>       return <div key={index}>Hello, {name}!</div>
>     })
>   }
>   </div>,
>   document.getElementById('example')
> );
> ```

ä¸Šé¢ä»£ç ä½“ç°äº† JSX çš„åŸºæœ¬è¯­æ³•è§„åˆ™ï¼šé‡åˆ° HTML æ ‡ç­¾ï¼ˆä»¥ `<` å¼€å¤´ï¼‰ï¼Œå°±ç”¨ HTML è§„åˆ™è§£æï¼›é‡åˆ°ä»£ç å—ï¼ˆä»¥ `{` å¼€å¤´ï¼‰ï¼Œå°±ç”¨ JavaScript è§„åˆ™è§£æã€‚

![img](https://www.ruanyifeng.com/blogimg/asset/2015/bg2015033106.png)

#### JSXä¸­ä¼šå±•å¼€æ•°ç»„

JSX å…è®¸ç›´æ¥åœ¨æ¨¡æ¿æ’å…¥ JavaScript å˜é‡ã€‚å¦‚æœè¿™ä¸ªå˜é‡æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåˆ™ä¼šå±•å¼€è¿™ä¸ªæ•°ç»„çš„æ‰€æœ‰æˆå‘˜ï¼ˆæŸ¥çœ‹ [`demo03`](https://github.com/ruanyf/react-demos/blob/master/demo03/index.html) ï¼‰ã€‚

> ```javascript
> var arr = [
>   <h1>Hello world!</h1>,
>   <h2>React is awesome</h2>,
> ];
> ReactDOM.render(
>   <div>{arr}</div>,
>   document.getElementById('example')
> );
> ```

ä¸Šé¢ä»£ç çš„`arr`å˜é‡æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œç»“æœ JSX ä¼šæŠŠå®ƒçš„æ‰€æœ‰æˆå‘˜ï¼Œæ·»åŠ åˆ°æ¨¡æ¿ã€‚

![img](https://www.ruanyifeng.com/blogimg/asset/2015/bg2015033107.png)

## ç»„ä»¶

#### â€œç»„ä»¶ç±»â€

React å…è®¸å°†ä»£ç å°è£…æˆç»„ä»¶ï¼ˆcomponentï¼‰ï¼Œç„¶ååƒæ’å…¥æ™®é€š HTML æ ‡ç­¾ä¸€æ ·ï¼Œåœ¨ç½‘é¡µä¸­æ’å…¥è¿™ä¸ªç»„ä»¶ã€‚`React.createClass` æ–¹æ³•å°±ç”¨äºç”Ÿæˆä¸€ä¸ªç»„ä»¶ç±»ï¼ˆæŸ¥çœ‹ [`demo04`](https://github.com/ruanyf/react-demos/blob/master/demo04/index.html)ï¼‰ã€‚

> æ—§ç‰ˆæœ¬
>
> ```jsx
> var HelloMessage = React.createClass({
>   render: function() {
>     return <h1>Hello {this.props.name}</h1>;
>   }
> });
> 
> ReactDOM.render(
>   <HelloMessage name="John" />,
>   document.getElementById('example')
> );
> ```

> æ–°ç‰ˆæœ¬
>
> ```jsx
> class HelloMessage extends React.Component{
>     render(){
>         return <h1>Hello {this.props.name}</h1>;
>     }
> }
> ```
>
> ç»„ä»¶â€œç±»â€

ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡ `HelloMessage` å°±æ˜¯ä¸€ä¸ªç»„ä»¶ç±»ã€‚æ¨¡æ¿æ’å…¥ `<HelloMessage />` æ—¶ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆ `HelloMessage` çš„ä¸€ä¸ªå®ä¾‹ï¼ˆä¸‹æ–‡çš„"ç»„ä»¶"éƒ½æŒ‡ç»„ä»¶ç±»çš„å®ä¾‹ï¼‰

> â€œè‡ªåŠ¨ç”Ÿæˆç»„ä»¶ç±»çš„ä¸€ä¸ªå®ä¾‹â€è¿™ä¸ªæ¦‚å¿µå¥½åƒä¹‹å‰æ²¡å¬è§è¿‡ï¼å­¦ä¹ äº†ï¼

#### ç»„ä»¶ç±»ä½¿ç”¨renderæ–¹æ³•è¾“å‡ºç»„ä»¶

æ‰€æœ‰ç»„ä»¶ç±»éƒ½å¿…é¡»æœ‰è‡ªå·±çš„ `render` æ–¹æ³•ï¼Œç”¨äºè¾“å‡ºç»„ä»¶ã€‚

æ³¨æ„ï¼Œç»„ä»¶ç±»çš„ç¬¬ä¸€ä¸ªå­—æ¯å¿…é¡»å¤§å†™ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼Œæ¯”å¦‚`HelloMessage`ä¸èƒ½å†™æˆ`helloMessage`ã€‚

> å¦å¤–ï¼Œç»„ä»¶ç±»åªèƒ½åŒ…å«ä¸€ä¸ªé¡¶å±‚æ ‡ç­¾ï¼Œå¦åˆ™ä¹Ÿä¼šæŠ¥é”™ã€‚
>
> > ```jsx
> > var HelloMessage = React.createClass({
> >   render: function() {
> >     return <h1>
> >       Hello {this.props.name}
> >     </h1><p>
> >       some text
> >     </p>;
> >   }
> > });
> > ```
>
> ä¸Šé¢ä»£ç ä¼šæŠ¥é”™ï¼Œå› ä¸º`HelloMessage`ç»„ä»¶åŒ…å«äº†ä¸¤ä¸ªé¡¶å±‚æ ‡ç­¾ï¼š`h1`å’Œ`p`ã€‚

#### ç»„ä»¶å®ä¾‹ä»ç»„ä»¶ç±»çš„`this.props`å¯¹è±¡è·å–å±æ€§

ç»„ä»¶çš„ç”¨æ³•ä¸åŸç”Ÿçš„ HTML æ ‡ç­¾å®Œå…¨ä¸€è‡´ï¼Œå¯ä»¥ä»»æ„åŠ å…¥å±æ€§ï¼Œæ¯”å¦‚ `<HelloMessage name="John">` ï¼Œå°±æ˜¯ `HelloMessage` ç»„ä»¶åŠ å…¥ä¸€ä¸ª `name` å±æ€§ï¼Œå€¼ä¸º `John`ã€‚ç»„ä»¶çš„å±æ€§å¯ä»¥**åœ¨ç»„ä»¶ç±»çš„ `this.props` å¯¹è±¡ä¸Šè·å–**ï¼Œæ¯”å¦‚ `name` å±æ€§å°±å¯ä»¥é€šè¿‡ `this.props.name` è¯»å–ã€‚

#### ç»„ä»¶å±æ€§åçš„æ³¨æ„ç‚¹

æ·»åŠ ç»„ä»¶å±æ€§ï¼Œæœ‰ä¸€ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼Œå°±æ˜¯ `class` å±æ€§éœ€è¦å†™æˆ `className` ï¼Œ`for` å±æ€§éœ€è¦å†™æˆ `htmlFor` ï¼Œè¿™æ˜¯å› ä¸º `class` å’Œ `for` æ˜¯ JavaScript çš„ä¿ç•™å­—ã€‚

## Props

#### `this.props.children`-ç»„ä»¶æ‰€æœ‰å­èŠ‚ç‚¹

`this.props` å¯¹è±¡çš„å±æ€§ä¸ç»„ä»¶çš„å±æ€§ä¸€ä¸€å¯¹åº”ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªä¾‹å¤–ï¼Œå°±æ˜¯ `this.props.children` å±æ€§ã€‚å®ƒè¡¨ç¤ºç»„ä»¶çš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼ˆæŸ¥çœ‹ [`demo05`](https://github.com/ruanyf/react-demos/blob/master/demo05/index.html)ï¼‰ã€‚

> æ—§ç‰ˆæœ¬
>
> ```jsx
> var NotesList = React.createClass({
>   render: function() {
>     return (
>       <ol>
>       {
>         React.Children.map(this.props.children, function (child) {
>           return <li>{child}</li>;
>         })
>       }
>       </ol>
>     );
>   }
> });
> 
> ReactDOM.render(
>   <NotesList>
>     <span>hello</span>
>     <span>world</span>
>   </NotesList>,
>   document.body
> );
> ```

> æ–°ç‰ˆæœ¬
>
> ```jsx
> class NotesList extends React.Component{
>     render(){
>         return (
>         	<ol>
>             	{
>                     React.Children.map(this.props.children, function(child){
>                         return <li>{child}</li>
>                     })
>                 }
>             </ol>
>         )
>     }
> }
> ```



ä¸Šé¢ä»£ç çš„ `NoteList` ç»„ä»¶æœ‰ä¸¤ä¸ª `span` å­èŠ‚ç‚¹ï¼Œå®ƒä»¬éƒ½å¯ä»¥é€šè¿‡ `this.props.children` è¯»å–ï¼Œè¿è¡Œç»“æœå¦‚ä¸‹ã€‚

![img](https://www.ruanyifeng.com/blogimg/asset/2015/bg2015033110.png)

#### ç”¨`React.Children.map`éå†å­èŠ‚ç‚¹

è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œ `this.props.children` çš„å€¼æœ‰ä¸‰ç§å¯èƒ½ï¼š

- å¦‚æœå½“å‰ç»„ä»¶æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œå®ƒå°±æ˜¯ `undefined` ;
- å¦‚æœæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œæ•°æ®ç±»å‹æ˜¯ `object` ï¼›
- å¦‚æœæœ‰å¤šä¸ªå­èŠ‚ç‚¹ï¼Œæ•°æ®ç±»å‹å°±æ˜¯ `array` ã€‚

æ‰€ä»¥ï¼Œå¤„ç† `this.props.children` çš„æ—¶å€™è¦å°å¿ƒã€‚

React æä¾›ä¸€ä¸ªå·¥å…·æ–¹æ³• [`React.Children-ä¸­æ–‡æ–‡æ¡£`](https://zh-hans.reactjs.org/docs/react-api.html#reactchildren) æ¥å¤„ç† `this.props.children` ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ `React.Children.map` æ¥éå†å­èŠ‚ç‚¹ï¼Œè€Œä¸ç”¨æ‹…å¿ƒ `this.props.children` çš„æ•°æ®ç±»å‹æ˜¯ `undefined` è¿˜æ˜¯ `object`ã€‚æ›´å¤šçš„ `React.Children` çš„æ–¹æ³•ï¼Œè¯·å‚è€ƒ[å®˜æ–¹æ–‡æ¡£-è‹±æ–‡åŸç‰ˆ](https://reactjs.org/docs/react-api.html#reactchildren)ã€‚



#### `PropTypes`-éªŒè¯ä½¿ç”¨ç»„ä»¶æ—¶æä¾›çš„å‚æ•°æ˜¯å¦ç¬¦åˆè¦æ±‚

> è€ç‰ˆæœ¬ä¸­é˜®å¤§ä½¿ç”¨ `const Com React.createClass`åˆ›å»ºç»„ä»¶ï¼Œä¸æˆ‘ä¹‹å‰å­¦åˆ°çš„ï¼ˆæ›´æ¥è¿‘ES6è§„èŒƒçš„classå†™æ³•ï¼‰`class Com extends React.Component` ä¸å¤ªä¸€æ ·ï¼Œä¸”ä¸€äº›åœ°æ–¹çš„ç”¨æ³•ä¹Ÿä¸åŒ
>
> å¯ä»¥çœ‹çœ‹[è¿™ç¯‡æ–‡ç« ](https://www.cnblogs.com/fightjianxian/p/12350499.html)æ‰€é˜è¿°çš„è¿™ä¸¤è€…ä¹‹é—´çš„åŒºåˆ«
>
> ```jsx
>     1ã€è¯­æ³•åŒºåˆ«
>     2ã€propType å’Œ getDefaultProps
>     3ã€çŠ¶æ€çš„åŒºåˆ«
>     4ã€thisåŒºåˆ«
>     5ã€Mixins
> ```

ç»„ä»¶çš„å±æ€§å¯ä»¥æ¥å—ä»»æ„å€¼ï¼Œå­—ç¬¦ä¸²ã€å¯¹è±¡ã€å‡½æ•°ç­‰ç­‰éƒ½å¯ä»¥ã€‚æœ‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æœºåˆ¶ï¼ŒéªŒè¯åˆ«äººä½¿ç”¨ç»„ä»¶æ—¶ï¼Œæä¾›çš„å‚æ•°æ˜¯å¦ç¬¦åˆè¦æ±‚ã€‚

ç»„ä»¶ç±»çš„`PropTypes`å±æ€§ï¼Œå°±æ˜¯ç”¨æ¥éªŒè¯ç»„ä»¶å®ä¾‹çš„å±æ€§æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼ˆæŸ¥çœ‹ [`demo06`](https://github.com/ruanyf/react-demos/blob/master/demo06/index.html)ï¼‰ã€‚

> è€ç‰ˆæœ¬
>
> é€šè¿‡`proTypes`å¯¹è±¡å’Œ`getDefaultProps()`æ–¹æ³•æ¥è®¾ç½®å’Œè·å–`props`.
>
> ```jsx
> var MyTitle = React.createClass({
>     propTypes: {
>         title:React.PropTypes.string.isRequired,
>     },
>     render: function(){
>         return <h1>{this.props.title}</h1>
>     }
> })
> ```

> æ–°ç‰ˆæœ¬
>
> é€šè¿‡è®¾ç½®ä¸¤ä¸ªå±æ€§`propTypes`å’Œ`defaultProps`
>
> ```jsx
> class MyTitle extends React.Component{
>     //  æ”¹ä¸ºå±æ€§
>     static propTypes = {
>         title: PropType.string.isRequired,
>     }
> 	render(){
>         return <h1> {this.props.title} </h1>;
>     }
> }
> ```
>
> 

ä¸Šé¢çš„`Mytitle`ç»„ä»¶æœ‰ä¸€ä¸ª`title`å±æ€§ã€‚`PropTypes` å‘Šè¯‰ Reactï¼Œè¿™ä¸ª `title` å±æ€§æ˜¯å¿…é¡»çš„ï¼Œ**è€Œä¸”å®ƒçš„å€¼å¿…é¡»æ˜¯å­—ç¬¦ä¸²**ã€‚

ä¸¾ä¸ªåä¾‹æ¥æµ‹è¯•ä¸‹

è®¾ç½® `title` å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªæ•°å€¼ã€‚

> ```jsx
> var data = 123;
> 
> ReactDOM.render(
>   <MyTitle title={data} />,
>   document.body
> );
> ```

è¿™æ ·ä¸€æ¥ï¼Œ`title`å±æ€§å°±é€šä¸è¿‡éªŒè¯äº†ã€‚æ§åˆ¶å°ä¼šæ˜¾ç¤ºä¸€è¡Œé”™è¯¯ä¿¡æ¯ã€‚

> ```bash
> Warning: Failed propType: Invalid prop `title` of type `number` supplied to `MyTitle`, expected `string`.
> ```

æ›´å¤šçš„`PropTypes`è®¾ç½®ï¼Œå¯ä»¥æŸ¥çœ‹[å®˜æ–¹æ–‡æ¡£](https://zh-hans.reactjs.org/docs/typechecking-with-proptypes.html#gatsby-focus-wrapper)ã€‚



> [ä¹‹å‰åœ¨fccä¸­å­¦ä¹ åˆ°çš„ å®šä¹‰Propsç±»å‹](https://chinese.freecodecamp.org/learn/front-end-development-libraries/react/use-proptypes-to-define-the-props-you-expect)æ˜¯åœ¨ç»„ä»¶ç±»ä¹‹å¤–
>
> ä¸Šé¢å­¦ä¹ åˆ°çš„ç›´æ¥åœ¨ç»„ä»¶ç±»é‡Œé¢å®šä¹‰ä¹Ÿå¾ˆæ˜¯ç®€å•ï¼
>
> ```js
> class ShoppingCart extends React.Component {
>     constructor(porps){
>         super(props);
>     }
>     render(){
>         return <Items />
>     }
> }
> const Items = (porps) => {
>     return <h1>Current Quantity of Items in Cart:{props.quantity}</h1>
> }
> // è¿™é‡Œå®šä¹‰ propTypes å±æ€§ éªŒè¯ç»„ä»¶æ˜¯å¦æ¥æ”¶äº†æ­£ç¡®ç±»å‹çš„ props
> Items.propTypes = {quantity:PropTypes.number.isRequired};
> ```

#### `getDefaultProps`-è®¾ç½®ç»„ä»¶å±æ€§çš„é»˜è®¤å€¼



> æ—§ç‰ˆæœ¬
>
> ```jsx
> var MyTitle = React.createClass({
>   getDefaultProps : function () {
>     return {
>       title : 'Hello World'
>     };
>   },
> 
>   render: function() {
>      return <h1> {this.props.title} </h1>;
>    }
> });
> 
> ReactDOM.render(
>   <MyTitle />,
>   document.body
> );
> ```

> æ–°ç‰ˆæœ¬
>
> ```jsx
> class MyTitle extends React.Component{
>     static defaultProps = { 
>         // as static property
>         title: 'Hello World'
>     };
>     render(){
>         return <h1>{this.props.title}</h1>
>     }
> }
> ```

ä¸Šé¢ä»£ç ä¼šè¾“å‡º"Hello World"ã€‚

## State

#### ç»„ä»¶ä¸ç”¨æˆ·çš„äº’åŠ¨-`this.state`

React çš„ä¸€å¤§åˆ›æ–°ï¼Œå°±æ˜¯å°†ç»„ä»¶çœ‹æˆæ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œä¸€å¼€å§‹æœ‰ä¸€ä¸ªåˆå§‹çŠ¶æ€ï¼Œç„¶åç”¨æˆ·äº’åŠ¨ï¼Œå¯¼è‡´çŠ¶æ€å˜åŒ–ï¼Œä»è€Œè§¦å‘é‡æ–°æ¸²æŸ“ UI ï¼ˆæŸ¥çœ‹ [`demo08`](https://github.com/ruanyf/react-demos/blob/master/demo08/index.html) ï¼‰ã€‚

> æ—§ç‰ˆæœ¬
>
> ```jsx
> var LikeButton = React.createClass({
>   /*getInitialState: function() {
>     return {liked: false};
>   },*/
>   handleClick: function(event) {
>     this.setState({liked: !this.state.liked});
>   },
>   render: function() {
>     var text = this.state.liked ? 'like' : 'haven\'t liked';
>     return (
>       <p onClick={this.handleClick}>
>         You {text} this. Click to toggle.
>       </p>
>     );
>   }
> });
> 
> ReactDOM.render(
>   <LikeButton />,
>   document.getElementById('example')
> );
> ```

> æ–°ç‰ˆæœ¬
>
> ```jsx
> class LikeButton extends React.Component{
>     /*constructor(props){
>         super(props);
>         this.state = {
>             liked : false
>         }
>         this.handleClick = this.handleClick.bind(this);// æ—¶åˆ»è®°ä½è¦ç»‘å®šè¿™ä¸ªæ–¹æ³•
>     }*/
>     handleClick(event){
>         this.setState({
>             liked: !this.state.liked;
>         })
>     }
>     render(){
> 		var text = this.state.liked ? 'like' : 'haven\'t liked';
>         return(
>             <p onClick={this.handleClick}>
>         		You {text} this.Click to toggle
>         	</p>
>         )
>     }
> }
> ```



ä¸Šé¢ä»£ç æ˜¯ä¸€ä¸ª `LikeButton` ç»„ä»¶ï¼Œ

> å®ƒçš„ `getInitialState` æ–¹æ³•ç”¨äºå®šä¹‰â€”â€”
>
> - åˆå§‹çŠ¶æ€state(**æ–°ç‰ˆæœ¬ä¸­ä½¿ç”¨æ„é€ å‡½æ•°æ¥å®šä¹‰state**)ï¼Œä¹Ÿå°±æ˜¯**ä¸€ä¸ªå¯¹è±¡**ï¼Œè¿™ä¸ªå¯¹è±¡<u>å¯ä»¥é€šè¿‡ `this.state` å±æ€§è¯»å–</u>ã€‚

å½“ç”¨æˆ·ç‚¹å‡»ç»„ä»¶ï¼Œå¯¼è‡´çŠ¶æ€å˜åŒ–ï¼Œ`this.setState` æ–¹æ³•å°±ä¿®æ”¹çŠ¶æ€å€¼ï¼Œæ¯æ¬¡ä¿®æ”¹ä»¥åï¼Œ**è‡ªåŠ¨è°ƒç”¨ `this.render` æ–¹æ³•**ï¼Œå†æ¬¡æ¸²æŸ“ç»„ä»¶ã€‚

#### åŒºåˆ†propsä¸state

ç”±äº `this.props` å’Œ `this.state` éƒ½ç”¨äºæè¿°ç»„ä»¶çš„ç‰¹æ€§ï¼Œå¯èƒ½ä¼šäº§ç”Ÿæ··æ·†ã€‚

ä¸€ä¸ªç®€å•çš„åŒºåˆ†æ–¹æ³•æ˜¯ï¼š

- `this.props` è¡¨ç¤ºé‚£äº›ä¸€æ—¦å®šä¹‰ï¼Œå°±ä¸å†æ”¹å˜çš„ç‰¹æ€§
- è€Œ `this.state` æ˜¯ä¼šéšç€ç”¨æˆ·äº’åŠ¨è€Œäº§ç”Ÿå˜åŒ–çš„ç‰¹æ€§ã€‚

[å®˜æ–¹æ–‡æ¡£](https://react.docschina.org/docs/faq-state.html#what-is-the-difference-between-state-and-props)æ˜¯è¿™ä¹ˆè¯´çš„ï¼š

> propsï¼ˆâ€œpropertiesâ€ çš„ç¼©å†™ï¼‰å’Œ state éƒ½æ˜¯**æ™®é€šçš„ JavaScript å¯¹è±¡**ã€‚
> å®ƒä»¬éƒ½æ˜¯**ç”¨æ¥ä¿å­˜ä¿¡æ¯**çš„ï¼Œè¿™äº›ä¿¡æ¯å¯ä»¥æ§åˆ¶ç»„ä»¶çš„æ¸²æŸ“è¾“å‡ºï¼Œè€Œå®ƒä»¬çš„ä¸€ä¸ªé‡è¦çš„ä¸åŒç‚¹å°±æ˜¯ï¼š
>
> - props æ˜¯**ä¼ é€’ç»™ç»„ä»¶**çš„ï¼ˆç±»ä¼¼äºå‡½æ•°çš„å½¢å‚ï¼‰
> - è€Œ state æ˜¯**åœ¨ç»„ä»¶å†…è¢«ç»„ä»¶è‡ªå·±ç®¡ç†çš„**ï¼ˆç±»ä¼¼äºåœ¨ä¸€ä¸ªå‡½æ•°å†…å£°æ˜çš„å˜é‡ï¼‰

> å®˜æ–¹æ¨èé˜…è¯»ææ–™
>
> - [Props vs State](https://github.com/uberVU/react-guide/blob/master/props-vs-state.md)
> - [ReactJS: Props vs. State](https://lucybain.com/blog/2016/react-state-vs-pros/)

## [Refs](https://zh-hans.reactjs.org/docs/refs-and-the-dom.html)

Refs æä¾›äº†ä¸€ç§æ–¹å¼ï¼Œå…è®¸æˆ‘ä»¬**è®¿é—® DOM èŠ‚ç‚¹æˆ–åœ¨ render æ–¹æ³•ä¸­åˆ›å»ºçš„ React å…ƒç´ **ã€‚

åœ¨å…¸å‹çš„ React æ•°æ®æµä¸­ï¼Œ[props](https://zh-hans.reactjs.org/docs/components-and-props.html) æ˜¯çˆ¶ç»„ä»¶ä¸å­ç»„ä»¶äº¤äº’çš„å”¯ä¸€æ–¹å¼ã€‚è¦ä¿®æ”¹ä¸€ä¸ªå­ç»„ä»¶ï¼Œä½ éœ€è¦ä½¿ç”¨æ–°çš„ props æ¥é‡æ–°æ¸²æŸ“å®ƒã€‚

ä½†æ˜¯ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ éœ€è¦åœ¨å…¸å‹æ•°æ®æµä¹‹å¤–å¼ºåˆ¶ä¿®æ”¹å­ç»„ä»¶ã€‚è¢«ä¿®æ”¹çš„å­ç»„ä»¶å¯èƒ½æ˜¯ä¸€ä¸ª React ç»„ä»¶çš„å®ä¾‹ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ª DOM å…ƒç´ ã€‚å¯¹äºè¿™ä¸¤ç§æƒ…å†µï¼ŒReact éƒ½æä¾›äº†è§£å†³åŠæ³•ã€‚

#### ä½•æ—¶ä½¿ç”¨ Refs

ä¸‹é¢æ˜¯å‡ ä¸ªé€‚åˆä½¿ç”¨ refs çš„æƒ…å†µï¼š

- ç®¡ç†ç„¦ç‚¹ï¼Œæ–‡æœ¬é€‰æ‹©æˆ–åª’ä½“æ’­æ”¾ã€‚
- è§¦å‘å¼ºåˆ¶åŠ¨ç”»ã€‚
- é›†æˆç¬¬ä¸‰æ–¹ DOM åº“ã€‚

é¿å…ä½¿ç”¨ refs æ¥åšä»»ä½•å¯ä»¥é€šè¿‡å£°æ˜å¼å®ç°æ¥å®Œæˆçš„äº‹æƒ…ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œé¿å…åœ¨ `Dialog` ç»„ä»¶é‡Œæš´éœ² `open()` å’Œ `close()` æ–¹æ³•ï¼Œæœ€å¥½ä¼ é€’ `isOpen` å±æ€§ã€‚

#### å‹¿è¿‡åº¦ä½¿ç”¨ Refs

ä½ å¯èƒ½é¦–å…ˆä¼šæƒ³åˆ°ä½¿ç”¨ refs åœ¨ä½ çš„ app ä¸­â€œè®©äº‹æƒ…å‘ç”Ÿâ€ã€‚å¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼Œè¯·èŠ±ä¸€ç‚¹æ—¶é—´ï¼Œè®¤çœŸå†è€ƒè™‘ä¸€ä¸‹ state å±æ€§åº”è¯¥è¢«å®‰æ’åœ¨å“ªä¸ªç»„ä»¶å±‚ä¸­ã€‚é€šå¸¸ä½ ä¼šæƒ³æ˜ç™½ï¼Œè®©æ›´é«˜çš„ç»„ä»¶å±‚çº§æ‹¥æœ‰è¿™ä¸ª stateï¼Œæ˜¯æ›´æ°å½“çš„ã€‚æŸ¥çœ‹ [çŠ¶æ€æå‡](https://zh-hans.reactjs.org/docs/lifting-state-up.html) ä»¥è·å–æ›´å¤šæœ‰å…³ç¤ºä¾‹ã€‚

#### å®ä¾‹-åˆ›å»º Refs

Refs æ˜¯ä½¿ç”¨ `React.createRef()` åˆ›å»ºçš„ï¼Œå¹¶é€šè¿‡ `ref` å±æ€§é™„åŠ åˆ° React å…ƒç´ ã€‚åœ¨æ„é€ ç»„ä»¶æ—¶ï¼Œé€šå¸¸å°† Refs åˆ†é…ç»™å®ä¾‹å±æ€§ï¼Œä»¥ä¾¿å¯ä»¥åœ¨æ•´ä¸ªç»„ä»¶ä¸­å¼•ç”¨å®ƒä»¬ã€‚

```jsx
class MyComponent extends React.Component {
  constructor(props) {
    super(props);
    this.myRef = React.createRef();  }
  render() {
    return <div ref={this.myRef} />;  }
}
```

#### è®¿é—® Refs

å½“ ref è¢«ä¼ é€’ç»™ `render` ä¸­çš„å…ƒç´ æ—¶ï¼Œ<u>å¯¹è¯¥èŠ‚ç‚¹çš„å¼•ç”¨å¯ä»¥åœ¨ ref çš„ `current` å±æ€§ä¸­è¢«è®¿é—®ã€‚</u>

```jsx
const node = this.myRef.current;
```

ref çš„å€¼æ ¹æ®èŠ‚ç‚¹çš„ç±»å‹è€Œæœ‰æ‰€ä¸åŒï¼š

- å½“ `ref` å±æ€§ç”¨äº HTML å…ƒç´ æ—¶ï¼Œæ„é€ å‡½æ•°ä¸­ä½¿ç”¨ `React.createRef()` åˆ›å»ºçš„ `ref` æ¥æ”¶åº•å±‚ DOM å…ƒç´ ä½œä¸ºå…¶ `current` å±æ€§ã€‚
- å½“ `ref` å±æ€§ç”¨äºè‡ªå®šä¹‰ class ç»„ä»¶æ—¶ï¼Œ`ref` å¯¹è±¡æ¥æ”¶ç»„ä»¶çš„æŒ‚è½½å®ä¾‹ä½œä¸ºå…¶ `current` å±æ€§ã€‚
- **ä½ ä¸èƒ½åœ¨å‡½æ•°ç»„ä»¶ä¸Šä½¿ç”¨ `ref` å±æ€§**ï¼Œå› ä¸ºä»–ä»¬æ²¡æœ‰å®ä¾‹ã€‚

#### å®ä¾‹-å°†è™šæ‹ŸDOMæ’å…¥æ–‡æ¡£ï¼Œè·å–çœŸå®DOM

ç»„ä»¶å¹¶ä¸æ˜¯çœŸå®çš„ DOM èŠ‚ç‚¹ï¼Œè€Œæ˜¯å­˜åœ¨äºå†…å­˜ä¹‹ä¸­çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œå«åšè™šæ‹Ÿ DOM ï¼ˆvirtual DOMï¼‰ã€‚åªæœ‰å½“å®ƒæ’å…¥æ–‡æ¡£ä»¥åï¼Œæ‰ä¼šå˜æˆçœŸå®çš„ DOM ã€‚

æ ¹æ® React çš„è®¾è®¡ï¼Œ**æ‰€æœ‰çš„ DOM å˜åŠ¨ï¼Œéƒ½å…ˆåœ¨è™šæ‹Ÿ DOM ä¸Šå‘ç”Ÿï¼Œç„¶åå†å°†å®é™…å‘ç”Ÿå˜åŠ¨çš„éƒ¨åˆ†ï¼Œåæ˜ åœ¨çœŸå® DOMä¸Š**ï¼Œè¿™ç§ç®—æ³•å«åš [DOM diff](https://zh-hans.reactjs.org/docs/reconciliation.html#the-diffing-algorithm) ï¼Œå®ƒå¯ä»¥æå¤§æé«˜ç½‘é¡µçš„æ€§èƒ½è¡¨ç°ã€‚

ä½†æ˜¯ï¼Œæœ‰æ—¶éœ€è¦ä»ç»„ä»¶è·å–çœŸå® DOM çš„èŠ‚ç‚¹ï¼Œè¿™æ—¶å°±è¦ç”¨åˆ° `ref` å±æ€§ï¼ˆæŸ¥çœ‹ [demo07](https://github.com/ruanyf/react-demos/blob/master/demo07/index.html) ï¼‰ã€‚

> æ—§ç‰ˆæœ¬
>
> ```jsx
> var MyComponent = React.createClass({
>     handleClick: function(){
>         this.refs.myTextInput.focus();
>     }
>     render: function() {
>     	return (
>           <div>
>             <input type="text" ref="myTextInput" />
>             <input type="button" value="Focus the text input" onClick={this.handleClick} />
>           </div>
>         );
>       }
> })
> ```
>
> éœ€è¦æ³¨æ„ï¼Œæœ¬ä¾‹ä¸­æåˆ°çš„[å­—ç¬¦å‹çš„refå±æ€§å·²ç»è¿‡æ—¶äº†](https://zh-hans.reactjs.org/docs/refs-and-the-dom.html#legacy-api-string-refs)ï¼ï¼ˆä¸»è¦æ˜¯å› ä¸ºæ•ˆç‡ä¸é«˜+å­˜åœ¨[ä¸€äº›é—®é¢˜](https://github.com/facebook/react/pull/8333#issuecomment-271648615)ï¼‰
>
> ä¸è¿‡ç”¨è¿™ä¸ªçš„ç¨‹åºå‘˜å¯èƒ½è¿˜æŒºå¤š å› ä¸ºæ¯”è¾ƒç®€å•çœäº‹å„¿~
>
> ä¸¥è°¨èµ·è§ï¼Œå»ºè®®ä½¿ç”¨ä¸‹é¢æ–°ç‰ˆæœ¬ä¸­çš„[å›è°ƒå‡½æ•°æ–¹å¼](https://zh-hans.reactjs.org/docs/refs-and-the-dom.html#caveats-with-callback-refs)ï¼

> [æ–°ç‰ˆæœ¬](https://github.com/ruanyf/react-demos/blob/master/demo07/index.html)
>
> ä½¿ç”¨äº†[`React.createRef`](https://zh-hans.reactjs.org/docs/react-api.html#reactcreateref)ï¼Œåˆ›å»ºä¸€ä¸ªèƒ½å¤Ÿé€šè¿‡refå±æ€§é™„åŠ åˆ° React å…ƒç´ çš„ [ref](https://zh-hans.reactjs.org/docs/refs-and-the-dom.html)ã€‚
>
> ```jsx
> class MyComponent extends React.Component{
>     constructor(props){
>         super(props);
>         this.myTextInput = React.createRef();// myTextInputå°±æ˜¯åˆ›å»ºçš„Refs
>         this.handleClick = this.handleClick.bind(this);// ç»‘å®šç‚¹å‡»äº‹ä»¶
>     }
>     handleClick(){
>         //  ç‚¹å‡»äº‹ä»¶çš„å›è°ƒå‡½æ•°ï¼Œä½œç”¨ï¼šåœ¨ç‚¹å‡»æŒ‰é’®ä¹‹åå¯¹â€œrenderä¸­çš„å…ƒç´ â€è¿›è¡Œèšç„¦
>         this.myTextInput.current.focus();
>     }
>     render(){
>         return(
>             <div>
>                 {/* å°†refä¼ ç»™renderä¸­çš„å…ƒç´ ï¼Œå¯¹è¯¥èŠ‚ç‚¹ï¼ˆinputè¾“å…¥æ¡†ï¼‰çš„å¼•ç”¨å¯ä»¥åœ¨refçš„currentå±æ€§ä¸­è®¿é—®ï¼è§ä¸Šé¢ç¬¬9è¡Œçš„ä»£ç  */}
>                 <input type="text" ref={this.myTextInput} /> 
>                 <input type="button" value="Focus te text input" onClick={this.handleClick} />
>             </div>
>         )
>     }
>     
> }
> ```

ä¸Šé¢ä»£ç ä¸­ï¼Œç»„ä»¶ `MyComponent` çš„å­èŠ‚ç‚¹æœ‰ä¸€ä¸ªæ–‡æœ¬è¾“å…¥æ¡†ï¼Œç”¨äºè·å–ç”¨æˆ·çš„è¾“å…¥ã€‚è¿™æ—¶å°±å¿…é¡»**è·å–çœŸå®çš„ DOM èŠ‚ç‚¹**ï¼Œè™šæ‹Ÿ DOM æ˜¯æ‹¿ä¸åˆ°ç”¨æˆ·è¾“å…¥çš„ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ–‡æœ¬è¾“å…¥æ¡†å¿…é¡»æœ‰ä¸€ä¸ª `ref` å±æ€§ï¼Œç„¶å `this.refs.[refName]` å°±ä¼šè¿”å›è¿™ä¸ªçœŸå®çš„ DOM èŠ‚ç‚¹ã€‚

![image-20211026114118072](https://gitee.com/su-fangzhou/blog-image/raw/master/202110261141127.png)

> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äº `this.refs.[refName]` å±æ€§**è·å–çš„æ˜¯çœŸå® DOM** ï¼Œæ‰€ä»¥å¿…é¡»ç­‰åˆ°è™šæ‹Ÿ DOM æ’å…¥æ–‡æ¡£ä»¥åï¼Œæ‰èƒ½ä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚
>
> ä¸Šé¢ä»£ç ä¸­ï¼Œé€šè¿‡ä¸ºç»„ä»¶æŒ‡å®š `Click` äº‹ä»¶çš„å›è°ƒå‡½æ•°ï¼Œç¡®ä¿äº†åªæœ‰ç­‰åˆ°çœŸå® DOM å‘ç”Ÿ `Click` äº‹ä»¶ä¹‹åï¼Œæ‰ä¼šè¯»å– `this.refs.[refName]` å±æ€§ã€‚
>
> React ç»„ä»¶æ”¯æŒå¾ˆå¤šäº‹ä»¶ï¼Œé™¤äº† `Click` äº‹ä»¶ä»¥å¤–ï¼Œè¿˜æœ‰ `KeyDown` ã€`Copy`ã€`Scroll` ç­‰ï¼Œå®Œæ•´çš„äº‹ä»¶æ¸…å•è¯·æŸ¥çœ‹[å®˜æ–¹æ–‡æ¡£](https://facebook.github.io/react/docs/events.html#supported-events)ã€‚



## è¡¨å•



## è™šæ‹ŸDOMä¸DOM Diffingç®—æ³•

[Diffing ç®—æ³•](https://zh-hans.reactjs.org/docs/reconciliation.html#the-diffing-algorithm)



## ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ





## AJAX